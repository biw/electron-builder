{"version":3,"file":"RepoSlugTest.js","sourceRoot":"","sources":["../src/RepoSlugTest.ts"],"names":[],"mappings":";;AAAA,4EAA2E;AAG3E,SAAS,SAAS,CAAC,MAAoB,EAAE,IAAS;IAChD,OAAO,IAAI,CAAC,SAAS,CAAA;IACrB,OAAO,IAAI,CAAC,YAAY,CAAA;IACxB,OAAO,IAAI,CAAC,aAAa,CAAA;IACzB,OAAO,IAAI,CAAC,YAAY,CAAA;IACxB,OAAO,IAAI,CAAC,YAAY,CAAA;IACxB,OAAO,IAAI,CAAC,IAAI,CAAA;IAChB,MAAM,CAAC,IAAI,CAAC,CAAC,eAAe,EAAE,CAAA;AAChC,CAAC;AAED,IAAI,CAAC,iCAAiC,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC3D,MAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAA;IAC7C,IAAI,CAAC;QACH,OAAO,CAAC,GAAG,CAAC,gBAAgB,GAAG,wBAAwB,CAAA;QACvD,MAAM,IAAI,GAAQ,MAAM,IAAA,kCAAiB,EAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAA;QACxD,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,CAAA;IACzB,CAAC;YAAS,CAAC;QACT,IAAI,QAAQ,IAAI,IAAI,EAAE,CAAC;YACrB,UAAU,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAA;QAC1C,CAAC;IACH,CAAC;AACH,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,yBAAyB,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACnD,MAAM,mBAAmB,GAAG,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAA;IAC1D,MAAM,UAAU,GAAG,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAA;IAC/C,IAAI,CAAC;QACH,IAAI,UAAU,IAAI,IAAI,EAAE,CAAC;YACvB,OAAO,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAA;QACrC,CAAC;QAED,OAAO,CAAC,GAAG,CAAC,kBAAkB,GAAG,wBAAwB,CAAA;QACzD,MAAM,IAAI,GAAG,MAAM,IAAA,kCAAiB,EAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAA;QACnD,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,CAAA;IACzB,CAAC;YAAS,CAAC;QACT,UAAU,CAAC,oBAAoB,EAAE,mBAAmB,CAAC,CAAA;QACrD,IAAI,UAAU,IAAI,IAAI,EAAE,CAAC;YACvB,OAAO,CAAC,GAAG,CAAC,gBAAgB,GAAG,UAAU,CAAA;QAC3C,CAAC;IACH,CAAC;AACH,CAAC,CAAC,CAAA;AAEF,SAAS,UAAU,CAAC,IAAY,EAAE,KAAyB;IACzD,IAAI,KAAK,IAAI,IAAI,EAAE,CAAC;QAClB,oDAAoD;QACpD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,KAAK,CAAA;IAC3B,CAAC;AACH,CAAC","sourcesContent":["import { getRepositoryInfo } from \"app-builder-lib/out/util/repositoryInfo\"\nimport { ExpectStatic } from \"vitest\"\n\nfunction checkInfo(expect: ExpectStatic, info: any) {\n  delete info.pathmatch\n  delete info.pathtemplate\n  delete info.httpstemplate\n  delete info.filetemplate\n  delete info.docstemplate\n  delete info.opts\n  expect(info).toMatchSnapshot()\n}\n\ntest(\"repo slug from TRAVIS_REPO_SLUG\", async ({ expect }) => {\n  const oldValue = process.env.TRAVIS_REPO_SLUG\n  try {\n    process.env.TRAVIS_REPO_SLUG = \"travis-ci/travis-build\"\n    const info: any = await getRepositoryInfo(process.cwd())\n    checkInfo(expect, info)\n  } finally {\n    if (oldValue != null) {\n      restoreEnv(\"TRAVIS_REPO_SLUG\", oldValue)\n    }\n  }\n})\n\ntest(\"repo slug from APPVEYOR\", async ({ expect }) => {\n  const oldAppveyorRepoName = process.env.APPVEYOR_REPO_NAME\n  const travisSlug = process.env.TRAVIS_REPO_SLUG\n  try {\n    if (travisSlug != null) {\n      delete process.env.TRAVIS_REPO_SLUG\n    }\n\n    process.env.APPVEYOR_REPO_NAME = \"travis-ci/travis-build\"\n    const info = await getRepositoryInfo(process.cwd())\n    checkInfo(expect, info)\n  } finally {\n    restoreEnv(\"APPVEYOR_REPO_NAME\", oldAppveyorRepoName)\n    if (travisSlug != null) {\n      process.env.TRAVIS_REPO_SLUG = travisSlug\n    }\n  }\n})\n\nfunction restoreEnv(name: string, value: string | undefined) {\n  if (value != null) {\n    // otherwise will be set to string value \"undefined\"\n    process.env[name] = value\n  }\n}\n"]}