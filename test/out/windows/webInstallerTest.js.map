{"version":3,"file":"webInstallerTest.js","sourceRoot":"","sources":["../../src/windows/webInstallerTest.ts"],"names":[],"mappings":";;AAAA,uDAAiD;AACjD,sDAA2C;AAE3C,0HAA0H;AAE1H,IAAI,CAAC,UAAU,CAAC,eAAe,EAAE,CAAC,EAAE,MAAM,EAAE,EAAE,EAAE,CAC9C,IAAA,gBAAG,EAAC,MAAM,EAAE;IACV,OAAO,EAAE,2BAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,UAAU,CAAC,EAAE,uBAAI,CAAC,GAAG,EAAE,uBAAI,CAAC,KAAK,CAAC;IAC1E,MAAM,EAAE;QACN,OAAO,EAAE;YACP,QAAQ,EAAE,IAAI;YACd,MAAM,EAAE,SAAS;YACjB,IAAI,EAAE,MAAM;SACb;QACD,aAAa,EAAE;YACb,SAAS,EAAE,IAAI;YACf,sBAAsB,EAAE,IAAI;YAC5B,oCAAoC,EAAE,IAAI;YAC1C,6BAA6B,EAAE,IAAI;YACnC,qCAAqC,EAAE,IAAI;YAC3C,mBAAmB,EAAE,IAAI;YACzB,oCAAoC,EAAE,IAAI;YAC1C,gCAAgC,EAAE,SAAS,EAAE,uDAAuD;SACrG;KACF;CACF,CAAC,CACH,CAAA;AAED,IAAI,CAAC,UAAU,CAAC,gCAAgC,EAAE,CAAC,EAAE,MAAM,EAAE,EAAE,EAAE,CAC/D,IAAA,gBAAG,EAAC,MAAM,EAAE;IACV,OAAO,EAAE,2BAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,UAAU,CAAC,EAAE,uBAAI,CAAC,IAAI,EAAE,uBAAI,CAAC,GAAG,EAAE,uBAAI,CAAC,KAAK,CAAC;IACrF,MAAM,EAAE;QACN,OAAO,EAAE;YACP,QAAQ,EAAE,QAAQ;YAClB,0BAA0B;YAC1B,IAAI,EAAE,SAAS;SAChB;KACF;CACF,CAAC,CACH,CAAA;AAED,IAAI,CAAC,UAAU,CAAC,oCAAoC,EAAE,CAAC,EAAE,MAAM,EAAE,EAAE,EAAE,CACnE,IAAA,gBAAG,EAAC,MAAM,EAAE;IACV,OAAO,EAAE,2BAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,UAAU,CAAC,EAAE,uBAAI,CAAC,GAAG,CAAC;IAC9D,MAAM,EAAE;QACN,WAAW,EAAE,WAAW;QACxB,OAAO,EAAE;YACP,QAAQ,EAAE,QAAQ;YAClB,IAAI,EAAE,SAAS;SAChB;QACD,OAAO,EAAE;YACP,sDAAsD;YACtD,YAAY,EAAE,uBAAuB;SACtC;KACF;CACF,CAAC,CACH,CAAA","sourcesContent":["import { Arch, Platform } from \"electron-builder\"\nimport { app } from \"../helpers/packTester\"\n\n// tests are heavy, to distribute tests across CircleCI machines evenly, these tests were moved from oneClickInstallerTest\n\ntest.ifNotCiMac(\"web installer\", ({ expect }) =>\n  app(expect, {\n    targets: Platform.WINDOWS.createTarget([\"nsis-web\"], Arch.x64, Arch.arm64),\n    config: {\n      publish: {\n        provider: \"s3\",\n        bucket: \"develar\",\n        path: \"test\",\n      },\n      electronFuses: {\n        runAsNode: true,\n        enableCookieEncryption: true,\n        enableNodeOptionsEnvironmentVariable: true,\n        enableNodeCliInspectArguments: true,\n        enableEmbeddedAsarIntegrityValidation: true,\n        onlyLoadAppFromAsar: true,\n        loadBrowserProcessSpecificV8Snapshot: true,\n        grantFileProtocolExtraPrivileges: undefined, // unsupported on current electron version in our tests\n      },\n    },\n  })\n)\n\ntest.ifNotCiMac(\"web installer (default github)\", ({ expect }) =>\n  app(expect, {\n    targets: Platform.WINDOWS.createTarget([\"nsis-web\"], Arch.ia32, Arch.x64, Arch.arm64),\n    config: {\n      publish: {\n        provider: \"github\",\n        // test form without owner\n        repo: \"foo/bar\",\n      },\n    },\n  })\n)\n\ntest.ifNotCiMac(\"web installer, safe name on github\", ({ expect }) =>\n  app(expect, {\n    targets: Platform.WINDOWS.createTarget([\"nsis-web\"], Arch.x64),\n    config: {\n      productName: \"WorkFlowy\",\n      publish: {\n        provider: \"github\",\n        repo: \"foo/bar\",\n      },\n      nsisWeb: {\n        //tslint:disable-next-line:no-invalid-template-strings\n        artifactName: \"${productName}.${ext}\",\n      },\n    },\n  })\n)\n"]}