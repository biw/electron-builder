{"version":3,"file":"packageManagerTest.js","sourceRoot":"","sources":["../src/packageManagerTest.ts"],"names":[],"mappings":"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","sourcesContent":["import { Platform } from \"app-builder-lib\"\nimport { PM } from \"app-builder-lib/src/node-module-collector\"\nimport { execSync } from \"child_process\"\nimport { copyFile, outputFile, rm, writeFile } from \"fs-extra\"\nimport * as path from \"path\"\nimport { assertThat } from \"./helpers/fileAssert\"\nimport { app, assertPack, getFixtureDir, getPackageManagerWithVersion, linuxDirTarget, modifyPackageJson, verifyAsarFileTree } from \"./helpers/packTester\"\nimport { ELECTRON_VERSION } from \"./helpers/testConfig\"\n\nconst yarnVersion = getPackageManagerWithVersion(PM.YARN).prepareEntry\nconst yarnBerryVersion = getPackageManagerWithVersion(PM.YARN_BERRY).prepareEntry\n\nconst packageConfig = (data: any, version: string) => {\n  data.packageManager = version\n  data.name = \"hello-world\"\n  data.version = \"1.0.0\"\n  data.dependencies = {\n    ...data.debpendencies,\n    debug: \"4.4.3\",\n  }\n  data.devDependencies = {\n    electron: ELECTRON_VERSION,\n  }\n  data.optionalDependencies = {}\n  return data\n}\n\ntest(\"yarn\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-yarn-hoisted\",\n    {\n      targets: linuxDirTarget,\n    },\n    {\n      storeDepsLockfileSnapshot: true,\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n      projectDirCreated: async projectDir => {\n        await modifyPackageJson(\n          projectDir,\n          data => {\n            data.packageManager = yarnVersion\n          },\n          false\n        )\n        await modifyPackageJson(projectDir, data => packageConfig(data, yarnVersion), true)\n        await writeFile(path.join(projectDir, \"yarn.lock\"), \"\")\n        await writeFile(path.join(projectDir, \"app\", \"yarn.lock\"), \"\")\n        await copyFile(path.join(getFixtureDir(), \".pnp.cjs\"), path.join(projectDir, \".pnp.cjs\"))\n        await rm(path.join(projectDir, \".yarnrc.yml\"))\n        execSync(\"yarn install\", { cwd: projectDir, stdio: \"inherit\" })\n        execSync(\"yarn install\", { cwd: path.join(projectDir, \"app\"), stdio: \"inherit\" })\n      },\n    }\n  ))\n\ntest(\"yarn berry\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-yarn-hoisted\",\n    {\n      targets: linuxDirTarget,\n    },\n    {\n      storeDepsLockfileSnapshot: true,\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n      projectDirCreated: async projectDir => {\n        await modifyPackageJson(\n          projectDir,\n          data => {\n            data.packageManager = yarnBerryVersion\n          },\n          false\n        )\n        await modifyPackageJson(projectDir, data => packageConfig(data, yarnBerryVersion), true)\n        await writeFile(path.join(projectDir, \"yarn.lock\"), \"\")\n        await writeFile(path.join(projectDir, \"app\", \"yarn.lock\"), \"\")\n        await copyFile(path.join(getFixtureDir(), \".pnp.cjs\"), path.join(projectDir, \".pnp.cjs\"))\n      },\n    }\n  ))\n\n// yarn workspace\ntest(\"yarn workspace\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-yarn-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/test-app\",\n    },\n    {\n      storeDepsLockfileSnapshot: true,\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n      projectDirCreated: async projectDir => {\n        await modifyPackageJson(projectDir, data => {\n          data.packageManager = yarnVersion\n        })\n        await modifyPackageJson(path.join(projectDir, \"packages\", \"test-app\"), data => packageConfig(data, yarnVersion))\n      },\n    }\n  ))\n\ntest(\"yarn berry workspace\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-yarn-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/test-app\",\n    },\n    {\n      storeDepsLockfileSnapshot: true,\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n      projectDirCreated: async projectDir => {\n        await modifyPackageJson(projectDir, data => {\n          data.packageManager = yarnBerryVersion\n        })\n        await modifyPackageJson(path.join(projectDir, \"packages\", \"test-app\"), data => packageConfig(data, yarnBerryVersion))\n      },\n    }\n  ))\n\n// yarn multi-package workspace\ntest(\"yarn multi-package workspace\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-yarn-several-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/test-app\",\n    },\n    {\n      storeDepsLockfileSnapshot: true,\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n      projectDirCreated: async projectDir => {\n        await modifyPackageJson(projectDir, data => {\n          data.packageManager = yarnVersion\n        })\n        await modifyPackageJson(path.join(projectDir, \"packages\", \"test-app\"), data => packageConfig(data, yarnVersion))\n      },\n    }\n  ))\n\n // yarn berry multi-package workspace\ntest(\"yarn berry multi-package workspace\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-yarn-several-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/test-app\",\n    },\n    {\n      storeDepsLockfileSnapshot: true,\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n      projectDirCreated: async projectDir => {\n        await modifyPackageJson(projectDir, data => {\n          data.packageManager = yarnBerryVersion\n        })\n        await modifyPackageJson(path.join(projectDir, \"packages\", \"test-app\"), data => packageConfig(data, yarnBerryVersion))\n      },\n    }\n  ))\n\n// yarn berry PnP workspace (Plug'n'Play mode - no node_modules)\ntest(\"yarn berry pnp workspace\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-yarn-pnp-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/app\",\n    },\n    {\n      projectDirCreated: async projectDir => {\n        const appPkg = path.join(projectDir, \"packages\", \"app\")\n        const libPkg = path.join(projectDir, \"packages\", \"lib\")\n\n        await Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.packageManager = yarnBerryVersion\n          }),\n          modifyPackageJson(appPkg, data => {\n            data.dependencies = {\n              lib: \"workspace:*\",\n              \"is-bigint\": \"1.1.0\",\n            }\n            data.devDependencies = {\n              electron: ELECTRON_VERSION,\n            }\n          }),\n          modifyPackageJson(libPkg, data => {\n            data.dependencies = {\n              \"left-pad\": \"1.3.0\",\n            }\n          }),\n        ])\n      },\n    }\n  ))\n\n// Test for pnpm package manager\nconst pnpmVersion = \"pnpm@10.18.0+sha512.e804f889f1cecc40d572db084eec3e4881739f8dec69c0ff10d2d1beff9a4e309383ba27b5b750059d7f4c149535b6cd0d2cb1ed3aeb739239a4284a68f40cfa\"\n\ntest(\"pnpm\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n    },\n    {\n      storeDepsLockfileSnapshot: true,\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n      projectDirCreated: projectDir =>\n        modifyPackageJson(\n          projectDir,\n          data => packageConfig(data, pnpmVersion),\n          false\n        ),\n    }\n  ))\n\n// pnpm workspace test (strict mode - default behavior)\ntest(\"pnpm workspace\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-pnpm-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/app\",\n    },\n    {\n      packageManager: PM.PNPM,\n      projectDirCreated: async projectDir => {\n        const appPkg = path.join(projectDir, \"packages\", \"app\")\n        const libPkg = path.join(projectDir, \"packages\", \"lib\")\n\n        await Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.packageManager = pnpmVersion\n          }),\n          modifyPackageJson(appPkg, data => {\n            data.dependencies = {\n              lib: \"workspace:*\",\n              \"is-bigint\": \"1.1.0\",\n            }\n            data.devDependencies = {\n              electron: ELECTRON_VERSION,\n            }\n          }),\n          modifyPackageJson(libPkg, data => {\n            data.dependencies = {\n              \"left-pad\": \"1.3.0\",\n            }\n          }),\n        ])\n      },\n    }\n  ))\n\n// pnpm workspace with conflicting versions\ntest(\"pnpm workspace - conflicting versions\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-pnpm-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/app\",\n    },\n    {\n      packageManager: PM.PNPM,\n      projectDirCreated: async projectDir => {\n        const appPkg = path.join(projectDir, \"packages\", \"app\")\n        const libPkg = path.join(projectDir, \"packages\", \"lib\")\n\n        await Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.packageManager = pnpmVersion\n          }),\n          modifyPackageJson(appPkg, data => {\n            data.dependencies = {\n              lib: \"workspace:*\",\n              \"is-bigint\": \"1.1.0\",\n            }\n            data.devDependencies = {\n              electron: ELECTRON_VERSION,\n            }\n          }),\n          modifyPackageJson(libPkg, data => {\n            data.dependencies = {\n              \"left-pad\": \"1.3.0\",\n              // conflicting version should be properly handled\n              \"is-bigint\": \"1.0.4\",\n            }\n          }),\n        ])\n      },\n    }\n  ))\n\n// Test for npm package manager\ntest(\"npm\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n    },\n    {\n      storeDepsLockfileSnapshot: true,\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n      projectDirCreated: projectDir => modifyPackageJson(projectDir, data => packageConfig(data, \"npm@9.8.1\"), false),\n    }\n  ))\n\n// TODO: Fix bun workspace with isolated linker - the dependency collector reads the workspace root's\n// package.json instead of the app's package.json, causing wrong dependencies to be collected.\n// See: https://github.com/electron-userland/electron-builder/issues/XXXX\ntest.skip(\"bun workspace --linker=isolated\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-bun-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/app\",\n    },\n    {\n      packageManager: PM.BUN,\n      projectDirCreated: projectDir => {\n        const appPkg = path.join(projectDir, \"packages\", \"app\")\n        const libPkg = path.join(projectDir, \"packages\", \"lib\")\n\n        return Promise.all([\n          // root pkgs should not be included\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              \"is-plain-obj\": \"3.0.0\",\n            }\n          }),\n          modifyPackageJson(appPkg, data => {\n            data.dependencies = {\n              lib: \"workspace:*\",\n              \"is-bigint\": \"1.1.0\",\n              process: \"^0.11.10\",\n            }\n          }),\n          modifyPackageJson(libPkg, data => {\n            data.dependencies = {\n              \"left-pad\": \"1.3.0\",\n            }\n          }),\n          outputFile(path.join(projectDir, \"bunfig.toml\"), '[install]\\nlinker = \"isolated\"\\n'),\n        ])\n      },\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n    }\n  )\n)\n\n// TODO: Fix bun workspace with isolated linker - same issue as above\ntest.skip(\"bun workspace --linker=isolated - multiple conflicting versions\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-bun-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/app\",\n    },\n    {\n      packageManager: PM.BUN,\n      projectDirCreated: projectDir => {\n        const appPkg = path.join(projectDir, \"packages\", \"app\")\n        const libPkg = path.join(projectDir, \"packages\", \"lib\")\n\n        return Promise.all([\n          // root pkgs should not be included\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              \"is-plain-obj\": \"3.0.0\",\n            }\n          }),\n          modifyPackageJson(appPkg, data => {\n            data.dependencies = {\n              lib: \"workspace:*\",\n              \"is-bigint\": \"1.1.0\",\n              process: \"^0.11.10\",\n            }\n          }),\n          modifyPackageJson(libPkg, data => {\n            data.dependencies = {\n              \"left-pad\": \"1.3.0\",\n              // should include this in a nested node_modules directory\n              \"is-bigint\": \"1.0.4\",\n            }\n          }),\n          outputFile(path.join(projectDir, \"bunfig.toml\"), '[install]\\nlinker = \"isolated\"\\n'),\n        ])\n      },\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n    }\n  )\n)\n\ntest(\"bun workspace --linker=hoisted\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-bun-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/app\",\n    },\n    {\n      packageManager: PM.BUN,\n      projectDirCreated: projectDir => {\n        const appPkg = path.join(projectDir, \"packages\", \"app\")\n        const libPkg = path.join(projectDir, \"packages\", \"lib\")\n\n        return Promise.all([\n          // root pkgs should not be included\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              \"is-plain-obj\": \"3.0.0\",\n            }\n          }),\n          modifyPackageJson(appPkg, data => {\n            data.dependencies = {\n              lib: \"workspace:*\",\n              \"is-bigint\": \"1.1.0\",\n              process: \"^0.11.10\",\n            }\n          }),\n          modifyPackageJson(libPkg, data => {\n            data.dependencies = {\n              \"left-pad\": \"1.3.0\",\n            }\n          }),\n          outputFile(path.join(projectDir, \"bunfig.toml\"), '[install]\\nlinker = \"hoisted\"\\n'),\n        ])\n      },\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n    }\n  )\n)\n\ntest(\"bun workspace --linker=hoisted - multiple conflicting versions\", ({ expect }) =>\n  assertPack(\n    expect,\n    \"test-app-bun-workspace\",\n    {\n      targets: linuxDirTarget,\n      projectDir: \"packages/app\",\n    },\n    {\n      packageManager: PM.BUN,\n      projectDirCreated: projectDir => {\n        const appPkg = path.join(projectDir, \"packages\", \"app\")\n        const libPkg = path.join(projectDir, \"packages\", \"lib\")\n\n        return Promise.all([\n          // root pkgs should not be included\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              \"is-plain-obj\": \"3.0.0\",\n            }\n          }),\n          modifyPackageJson(appPkg, data => {\n            data.dependencies = {\n              lib: \"workspace:*\",\n              \"is-bigint\": \"1.1.0\",\n              process: \"^0.11.10\",\n            }\n          }),\n          modifyPackageJson(libPkg, data => {\n            data.dependencies = {\n              \"left-pad\": \"1.3.0\",\n              // should include this in a nested node_modules directory, since it's a conflicting package version\n              \"is-bigint\": \"1.0.4\",\n            }\n          }),\n          outputFile(path.join(projectDir, \"bunfig.toml\"), '[install]\\nlinker = \"hoisted\"\\n'),\n        ])\n      },\n      packed: context => verifyAsarFileTree(expect, context.getResources(Platform.LINUX)),\n    }\n  ))\n\n// Test for local file:// protocol\n\nObject.values(PM)\n  .filter(pm => pm !== PM.BUN) // bun is not supported for file: protocol\n  .forEach(pm => {\n    test(`local file:// protocol with ${pm} for project outside workspace`, ({ expect }) => {\n      return assertPack(\n        expect,\n        \"test-app-one\",\n        {\n          targets: linuxDirTarget,\n          config: {\n            files: [\"**/*\"],\n            asarUnpack: [\"**/node_modules/foo/**/*\"],\n          },\n        },\n        {\n          storeDepsLockfileSnapshot: false,\n          packageManager: pm,\n          projectDirCreated: async (projectDir, tmpDir) => {\n            const tempDir = await tmpDir.getTempDir()\n            const localPath = path.join(tempDir, \"foo\")\n            await outputFile(path.join(localPath, \"package.json\"), `{\"name\":\"foo\",\"version\":\"9.0.0\",\"main\":\"index.js\",\"license\":\"MIT\",\"dependencies\":{\"ms\":\"2.0.0\"}}`)\n            await outputFile(path.join(localPath, \"index.js\"), `module.exports = require(\"ms\")`)\n\n            const pmCommand = getPackageManagerWithVersion(pm).cli\n            execSync(`${pmCommand} install`, { cwd: localPath, stdio: \"inherit\", env: { ...process.env, YARN_ENABLE_IMMUTABLE_INSTALLS: \"false\" } })\n            await modifyPackageJson(projectDir, data => {\n              data.dependencies = {\n                foo: `file:${localPath}`,\n              }\n            })\n\n            //`localPath` is dynamic and changes for every which causes `--frozen-lockfile` and `npm ci` to fail\n            execSync(`${pmCommand} install`, { cwd: projectDir, stdio: \"inherit\", env: { ...process.env, YARN_ENABLE_IMMUTABLE_INSTALLS: \"false\" } })\n          },\n          packed: async context => {\n            const resources = context.getResources(Platform.LINUX)\n            await assertThat(expect, path.join(resources, \"app.asar.unpacked\", \"node_modules\", \"foo\", \"package.json\")).isFile()\n          },\n        }\n      )\n    })\n  })\n"]}