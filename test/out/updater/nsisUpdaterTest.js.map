{"version":3,"file":"nsisUpdaterTest.js","sourceRoot":"","sources":["../../src/updater/nsisUpdaterTest.ts"],"names":[],"mappings":";;AACA,uDAAqD;AAErD,uCAAqC;AACrC,2BAA2B;AAC3B,6BAA4B;AAC5B,sDAAkD;AAClD,sDAAgE;AAChE,gEAAgH;AAKhH,MAAM,MAAM,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;AAE3B,IAAI,CAAC,8BAA8B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAChE,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,cAAc,CAAC,CAAA;IACvD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;KAC5B,CAAC,CAAA;IAEF,MAAM,YAAY,GAAkB,EAAE,CAAA;IACtC,MAAM,cAAc,GAAG,CAAC,qBAAqB,EAAE,sBAAsB,CAAU,CAAA;IAC/E,KAAK,MAAM,SAAS,IAAI,cAAc,EAAE,CAAC;QACvC,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,GAAG,EAAE;YAClC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;QAC9B,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IACzD,MAAM,CAAC,IAAA,qCAAwB,EAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,CAAC,eAAe,EAAE,CAAA;IACjF,wCAAwC;IACxC,MAAM,CAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,eAAe,CAAC,CAAC,aAAa,EAAE,CAAA;IAE1D,MAAM,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,CAAA;AAC9C,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,6BAA6B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC/D,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,eAAe,GAAG,IAAI,CAAA;IAC9B,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,UAAU;QACjB,IAAI,EAAE,kCAAkC;KACzC,CAAC,CAAA;IACF,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IACzD,MAAM,CAAC,IAAA,qCAAwB,EAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,CAAC,eAAe,EAAE,CAAA;AACnF,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,8BAA8B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAChE,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,eAAe,GAAG,KAAK,CAAA;IAC/B,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,UAAU;QACjB,IAAI,EAAE,kCAAkC;KACzC,CAAC,CAAA;IACF,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IACzD,MAAM,CAAC,IAAA,qCAAwB,EAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,CAAC,eAAe,EAAE,CAAA;AACnF,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,mDAAmD,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;;IACrF,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;KAC5B,CAAC,CAAA;IAEF,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IAE/B,MAAM,QAAQ,GAAG,MAAC,OAAe,aAAf,OAAO,uBAAP,OAAO,CAAU,qBAAqB,0CAAE,QAA0B,CAAA;IACpF,IAAI,QAAQ,EAAE,CAAC;QACb,MAAM,UAAU,GAAG,gBAAgB,CAAA;QACnC,MAAM,UAAU,GAAG,gBAAgB,CAAA;QACnC,MAAM,aAAa,GAAG,8DAA8D,UAAU,MAAM,CAAA;QACpG,MAAM,OAAO,GAAG,IAAI,GAAG,CAAC,aAAa,CAAC,CAAA;QAEtC,MAAM,YAAY,GAAG,MAAM,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAU,EAAE,UAAU,CAAC,CAAA;QACrF,MAAM,cAAc,GAAG,YAAY,CAAC,CAAC,CAAC,CAAA;QACtC,MAAM,cAAc,GAAG,YAAY,CAAC,CAAC,CAAC,CAAA;QAEtC,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,wFAAwF,CAAC,CAAA;QAC1H,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,wFAAwF,CAAC,CAAA;IAC5H,CAAC;AACH,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,kBAAkB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACpD,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAuB;QACvE,QAAQ,EAAE,SAAS;QACnB,GAAG,EAAE,uCAAuC;KAC7C,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,iBAAiB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACnF,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,OAAO,CAAC,aAAa,CAAC,UAAU,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC,CAAA;IAC3D,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,cAAc,IAAI,sCAAsC;QAC7E,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,cAAc,IAAI,sCAAsC;KAC9E,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,oBAAoB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACzF,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,MAAM,OAAO,GAAqB;QAChC,QAAQ,EAAE,WAAW;QACrB,KAAK,EAAE,QAAQ;QACf,IAAI,EAAE,uBAAuB;KAC9B,CAAA;IACD,OAAO,CAAC,aAAa,CAAC,qCAAkB,CAAC,kBAAkB,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,eAAgB,CAAC,CAAC,CAAA;IACzG,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAC3D,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,iBAAiB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACnD,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,MAAM,OAAO,GAAkB;QAC7B,QAAQ,EAAE,QAAQ;QAClB,SAAS,EAAE,QAAQ;KACpB,CAAA;IACD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAC3D,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAE;QACtC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAA;QAE1C,OAAQ,IAAY,CAAC,cAAc,CAAA;QACnC,MAAM,CAAC,IAAI,CAAC,CAAC,eAAe,EAAE,CAAA;IAChC,CAAC,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,wBAAwB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC1D,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,SAAS,EAAE,QAAQ;KACpB,CAAC,CAAA;IAEF,MAAM,YAAY,GAAkB,EAAE,CAAA;IACtC,MAAM,cAAc,GAAG,CAAC,qBAAqB,EAAE,kBAAkB,CAAU,CAAA;IAC3E,KAAK,MAAM,SAAS,IAAI,cAAc,EAAE,CAAC;QACvC,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,GAAG,EAAE;YAClC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;QAC9B,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IACzD,MAAM,CAAC,IAAA,qCAAwB,EAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,CAAC,eAAe,EAAE,CAAA;IACjF,MAAM,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,CAAA;AAC9C,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,0BAA0B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC5D,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,SAAS,EAAE,QAAQ;KACpB,CAAC,CAAA;IACF,OAAO,CAAC,YAAY,GAAG,KAAK,CAAA;IAE5B,MAAM,YAAY,GAAG,IAAA,6BAAW,EAAC,OAAO,CAAC,CAAA;IAEzC,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IACzD,MAAM,CAAC,IAAA,qCAAwB,EAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,CAAC,eAAe,EAAE,CAAA;IACjF,wCAAwC;IACxC,MAAM,CAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,eAAe,CAAC,CAAC,QAAQ,EAAE,CAAA;IACrD,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,EAAE,CAAA;IAEtC,MAAM,IAAA,uBAAU,EAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,OAAO,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAA;AACnF,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,uEAAuE,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;;IACzG,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,SAAS,EAAE,QAAQ;QACnB,YAAY,EAAE,gBAAgB;KAC/B,CAAC,CAAA;IAEF,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IAE/B,MAAM,QAAQ,GAAG,MAAC,OAAe,aAAf,OAAO,uBAAP,OAAO,CAAU,qBAAqB,0CAAE,QAA0B,CAAA;IACpF,IAAI,QAAQ,EAAE,CAAC;QACb,MAAM,OAAO,GAAG,IAAI,GAAG,CAAC,iEAAiE,CAAC,CAAA;QAC1F,MAAM,YAAY,GAAG,MAAM,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,CAAA;QAE/E,MAAM,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAA;QAEpC,MAAM,cAAc,GAAG,YAAY,CAAC,CAAC,CAAC,CAAA;QACtC,MAAM,cAAc,GAAG,YAAY,CAAC,CAAC,CAAC,CAAA;QACtC,MAAM,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,CAAA;QAC1C,MAAM,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,CAAA;QAC1C,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,uDAAuD,CAAC,CAAA;QAC9F,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,uDAAuD,CAAC,CAAA;IAChG,CAAC;AACH,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,wEAAwE,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;;IAC1G,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,SAAS,EAAE,QAAQ;QACnB,YAAY,EAAE,iBAAiB;KAChC,CAAC,CAAA;IAEF,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IAE/B,MAAM,QAAQ,GAAG,MAAC,OAAe,aAAf,OAAO,uBAAP,OAAO,CAAU,qBAAqB,0CAAE,QAA0B,CAAA;IACpF,IAAI,QAAQ,EAAE,CAAC;QACb,MAAM,OAAO,GAAG,IAAI,GAAG,CAAC,iEAAiE,CAAC,CAAA;QAC1F,MAAM,YAAY,GAAG,MAAM,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,CAAA;QAE/E,MAAM,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAA;QAEpC,MAAM,cAAc,GAAG,YAAY,CAAC,CAAC,CAAC,CAAA;QACtC,MAAM,cAAc,GAAG,YAAY,CAAC,CAAC,CAAC,CAAA;QACtC,MAAM,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,CAAA;QAC1C,MAAM,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,CAAA;QAC1C,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,0EAA0E,CAAC,CAAA;QAC5G,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,0EAA0E,CAAC,CAAA;IAC9G,CAAC;AACH,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC5D,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,IAAI,EAAE,uBAAuB;QAC7B,IAAI,EAAE,oBAAoB;QAC1B,MAAM,EAAE,MAAM;KACf,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,6BAA6B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC/E,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAuB;QACvE,QAAQ,EAAE,SAAS;QACnB,GAAG,EAAE,uCAAuC;QAC5C,OAAO,EAAE,MAAM;KAChB,CAAC,CAAA;IAEF,MAAM,YAAY,GAAG,IAAA,6BAAW,EAAC,OAAO,CAAC,CAAA;IAEzC,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IACzD,MAAM,CAAC,IAAA,qCAAwB,EAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,CAAC,eAAe,EAAE,CAAA;IACjF,MAAM,IAAA,uBAAU,EAAC,MAAM,EAAE,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,eAAe,CAAC,CAAC,MAAM,EAAE,CAAA;IAErE,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,EAAE,CAAA;AACxC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,oCAAoC,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACtE,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAuB;QACvE,QAAQ,EAAE,SAAS;QACnB,GAAG,EAAE,uCAAuC;KAC7C,CAAC,CAAA;IACF,OAAO,CAAC,YAAY,GAAG,KAAK,CAAA;IAE5B,MAAM,YAAY,GAAG,IAAA,6BAAW,EAAC,OAAO,CAAC,CAAA;IAEzC,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IACzD,MAAM,CAAC,IAAA,qCAAwB,EAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,CAAC,eAAe,EAAE,CAAA;IACjF,wCAAwC;IACxC,MAAM,CAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,eAAe,CAAC,CAAC,QAAQ,EAAE,CAAA;IACrD,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,EAAE,CAAA;IAEtC,MAAM,IAAA,uBAAU,EAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,OAAO,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAA;AACnF,CAAC,CAAC,CAAA;AAEF,oEAAoE;AACpE,IAAI,CAAC,+BAA+B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACjE,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAuB;QACvE,QAAQ,EAAE,SAAS;QACnB,GAAG,EAAE,uCAAuC;KAC7C,CAAC,CAAA;IAEF,MAAM,YAAY,GAAG,IAAA,6BAAW,EAAC,OAAO,CAAC,CAAA;IAEzC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;QAC5B,uCAAuC;QACvC,KAAK,OAAO,CAAC,eAAe,EAAE,CAAA;IAChC,CAAC;IAED,KAAK,UAAU,eAAe;QAC5B,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;QACzD,MAAM,CAAC,IAAA,qCAAwB,EAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,CAAC,eAAe,EAAE,CAAA;QACjF,MAAM,oBAAoB,CAAC,MAAM,EAAE,iBAAiB,CAAC,CAAA;IACvD,CAAC;IAED,MAAM,eAAe,EAAE,CAAA;IACvB,2CAA2C;IAC3C,MAAM,eAAe,EAAE,CAAA;IAEvB,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,EAAE,CAAA;AACxC,CAAC,CAAC,CAAA;AAEF,KAAK,UAAU,oBAAoB,CAAC,MAAoB,EAAE,iBAA2C;IACnG,OAAO,MAAM,IAAA,uBAAU,EAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CAAA,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,eAAe,CAAA,CAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAA;AACrG,CAAC;AAED,IAAI,CAAC,iBAAiB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACnD,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,MAAM,OAAO,GAAkB;QAC7B,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;KAC5B,CAAA;IACD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAC3D,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAE;QACtC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAA;QAE1C,OAAQ,IAAY,CAAC,cAAc,CAAA;QACnC,MAAM,CAAC,IAAI,CAAC,CAAC,eAAe,EAAE,CAAA;IAChC,CAAC,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,+CAA+C,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACjF,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,cAAc,CAAC,CAAA;IACvD,MAAM,OAAO,GAAkB;QAC7B,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;KAC5B,CAAA;IACD,OAAO,CAAC,aAAa,GAAG,IAAI,CAAA;IAC5B,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAC3D,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAE;QACtC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAA;QAE1C,OAAQ,IAAY,CAAC,cAAc,CAAA;QACnC,MAAM,CAAC,IAAI,CAAC,CAAC,eAAe,EAAE,CAAA;IAChC,CAAC,CAAC,CAAA;IACF,MAAM,iBAAiB,GAAG,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;IACjE,MAAM,CAAC,iBAAiB,aAAjB,iBAAiB,uBAAjB,iBAAiB,CAAE,UAAU,CAAC,CAAC,eAAe,EAAE,CAAA;AACzD,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,yBAAyB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACnH,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,6BAA6B;QACnC,OAAO,EAAE,IAAI;KACd,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,YAAY,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC9C,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,MAAM,YAAY,GAAG,IAAA,6BAAW,EAAC,OAAO,CAAC,CAAA;IAEzC,MAAM,IAAA,uBAAU,EAAC,MAAM,EAAE,OAAO,CAAC,eAAe,EAAE,CAAC,CAAC,MAAM,EAAE,CAAA;IAC5D,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,EAAE,CAAA;AACxC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,IAAI,CAAC,wBAAwB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC/D,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC;QACjD,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;KAC5B,CAAC,CAAA;IACF,OAAO,CAAC,YAAY,GAAG,KAAK,CAAA;IAE5B,MAAM,cAAc,GAAe,EAAE,CAAA;IAErC,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAA;IAEvD,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IAC/B,MAAM,OAAO,CAAC,cAAc,EAAE,CAAA;IAE9B,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAA;IAEvD,MAAM,SAAS,GAAG,cAAc,CAAC,GAAG,EAAE,CAAA;IAEtC,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;IACnC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAA;IACnD,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAA;AACrD,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,iBAAiB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACnD,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC;QACjD,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;QAC3B,aAAa,EAAE,CAAC,qBAAqB,CAAC;KACvC,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,0CAA0C,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC5E,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC;QACjD,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;QAC3B,aAAa,EAAE,CAAC,SAAS,EAAE,2EAA2E,EAAE,SAAS,CAAC;KACnH,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,0BAA0B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC5D,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC;QACjD,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;QAC3B,aAAa,EAAE,CAAC,2EAA2E,CAAC;KAC7F,CAAC,CAAA;IAEF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,SAAS,CAAC,mBAAmB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC/D,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC;QACjD,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;QAC3B,aAAa,EAAE,CAAC,SAAS,CAAC;KAC3B,CAAC,CAAA;IACF,MAAM,YAAY,GAAG,IAAA,6BAAW,EAAC,OAAO,CAAC,CAAA;IACzC,MAAM,IAAA,uBAAU,EACd,MAAM,EACN,OAAO,CAAC,eAAe,EAAE,CAAC,IAAI,CAAC,CAAC,EAAE,EAAO,EAAE,CAAC,EAAE,aAAF,EAAE,uBAAF,EAAE,CAAE,eAAe,CAAC,CACjE,CAAC,MAAM,EAAE,CAAA;IACV,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,EAAE,CAAA;AACxC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,SAAS,CAAC,gCAAgC,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC5E,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;QAC3B,aAAa,EAAE,CAAC,2EAA2E,CAAC;KAC7F,CAAC,CAAA;IACF,OAAO,CAAC,yBAAyB,GAAG,CAAC,aAAuB,EAAE,IAAY,EAAE,EAAE;QAC5E,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;IAC9B,CAAC,CAAA;IACD,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,SAAS,CAAC,wDAAwD,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACpG,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,SAAS;QAChB,IAAI,EAAE,qBAAqB;QAC3B,aAAa,EAAE,CAAC,2EAA2E,CAAC;KAC7F,CAAC,CAAA;IACF,OAAO,CAAC,yBAAyB,GAAG,CAAC,aAAuB,EAAE,IAAY,EAAE,EAAE;QAC5E,OAAO,OAAO,CAAC,OAAO,CAAC,+BAA+B,CAAC,CAAA;IACzD,CAAC,CAAA;IACD,MAAM,YAAY,GAAG,IAAA,6BAAW,EAAC,OAAO,CAAC,CAAA;IACzC,MAAM,IAAA,uBAAU,EACd,MAAM,EACN,OAAO,CAAC,eAAe,EAAE,CAAC,IAAI,CAAC,CAAC,EAAE,EAAO,EAAE,CAAC,EAAE,aAAF,EAAE,uBAAF,EAAE,CAAE,eAAe,CAAC,CACjE,CAAC,MAAM,EAAE,CAAA;IACV,MAAM,CAAC,YAAY,CAAC,CAAC,eAAe,EAAE,CAAA;AACxC,CAAC,CAAC,CAAA;AAEF,kBAAkB;AAClB,IAAI,CAAC,uBAAuB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACzD,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAA,WAAM,GAAE,EAAE,uBAAuB,EAAE,UAAU,EAAE,YAAY,CAAC,CAAA;IACzF,MAAM,IAAA,qBAAU,EAAC,UAAU,EAAE,sCAAsC,CAAC,CAAA;IAEpE,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAY;QAC5D,QAAQ,EAAE,IAAI;QACd,OAAO,EAAE,oBAAoB;QAC7B,MAAM,EAAE,SAAS;QACjB,IAAI,EAAE,MAAM;KACb,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,sBAAsB,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACxD,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAA,WAAM,GAAE,EAAE,uBAAuB,EAAE,UAAU,EAAE,YAAY,CAAC,CAAA;IACzF,MAAM,IAAA,qBAAU,EAAC,UAAU,EAAE,sCAAsC,CAAC,CAAA;IAEpE,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC;QACjD,QAAQ,EAAE,IAAI;QACd,OAAO,EAAE,0BAA0B;QACnC,MAAM,EAAE,SAAS;QACjB,IAAI,EAAE,MAAM;KACb,CAAC,CAAA;IACF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,EAAE,KAAK,CAAC,CAAA;AAChD,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,+BAA+B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACjE,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAC;QACjD,QAAQ,EAAE,SAAS;QACnB,GAAG,EAAE,4CAA4C;KAClD,CAAC,CAAA;IAEF,MAAM,cAAc,GAAe,EAAE,CAAA;IACrC,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAA;IAEvD,IAAI,SAAS,GAAG,KAAK,CAAA;IACrB,OAAO,CAAC,OAAO,CAAC,eAAe,CAAC,GAAG,EAAE,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAA;IAEzD,MAAM,WAAW,GAAG,MAAM,OAAO,CAAC,eAAe,EAAE,CAAA;IACnD,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,iBAAiB,CAAE,MAAM,EAAE,CAAA;IAExC,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;QAC9B,MAAM,SAAS,GAAG,cAAc,CAAC,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA;QAC3D,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;QACvC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAA;QACnD,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAA;IACzD,CAAC;IAED,MAAM,eAAe,GAAG,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,eAAe,CAAA;IACpD,MAAM,IAAA,uBAAU,EAAC,MAAM,EAAE,eAAe,CAAC,CAAC,MAAM,EAAE,CAAA;IAClD,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;AAC9B,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,2BAA2B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC7D,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,GAAE,CAAA;IACzC,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAuB;QACvE,QAAQ,EAAE,SAAS;QACnB,GAAG,EAAE,uCAAuC;KAC7C,CAAC,CAAA;IAEF,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;AACzC,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,2BAA2B,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IAC5E,MAAM,OAAO,GAAG,MAAM,IAAA,mCAAiB,EAAC,OAAO,CAAC,CAAA;IAChD,OAAO,CAAC,gBAAgB,GAAG,MAAM,IAAA,mCAAiB,EAAgB;QAChE,QAAQ,EAAE,QAAQ;QAClB,KAAK,EAAE,UAAU;QACjB,IAAI,EAAE,uBAAuB;KAC9B,CAAC,CAAA;IAEF,MAAM,YAAY,GAAG,IAAA,6BAAW,EAAC,OAAO,CAAC,CAAA;IACzC,MAAM,IAAA,kCAAgB,EAAC,MAAM,EAAE,OAAO,CAAC,CAAA;IACvC,uGAAuG;IACvG,OAAO,CAAC,cAAc,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;IACnC,MAAM,CAAC,YAAY,CAAC,CAAC,aAAa,CAAC,CAAC,qBAAqB,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,wBAAwB,CAAC,CAAC,CAAA;AAChI,CAAC,CAAC,CAAA","sourcesContent":["import { BitbucketOptions, GenericServerOptions, GithubOptions, GitlabOptions, KeygenOptions, S3Options, SpacesOptions } from \"builder-util-runtime\"\nimport { BitbucketPublisher } from \"electron-publish\"\nimport { UpdateCheckResult } from \"electron-updater\"\nimport { outputFile } from \"fs-extra\"\nimport { tmpdir } from \"os\"\nimport * as path from \"path\"\nimport { assertThat } from \"../helpers/fileAssert\"\nimport { removeUnstableProperties } from \"../helpers/packTester\"\nimport { createNsisUpdater, trackEvents, validateDownload, writeUpdateConfig } from \"../helpers/updaterTestUtil\"\nimport { ExpectStatic } from \"vitest\"\nimport { GitLabProvider } from \"electron-updater/src/providers/GitLabProvider\"\nimport { GitHubProvider } from \"electron-updater/src/providers/GitHubProvider\"\n\nconst config = { retry: 3 }\n\ntest(\"downgrade (disallowed, beta)\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.5.2-beta.4\")\n  updater.updateConfigPath = await writeUpdateConfig<GithubOptions>({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n  })\n\n  const actualEvents: Array<string> = []\n  const expectedEvents = [\"checking-for-update\", \"update-not-available\"] as const\n  for (const eventName of expectedEvents) {\n    updater.addListener(eventName, () => {\n      actualEvents.push(eventName)\n    })\n  }\n\n  const updateCheckResult = await updater.checkForUpdates()\n  expect(removeUnstableProperties(updateCheckResult?.updateInfo)).toMatchSnapshot()\n  // noinspection JSIgnoredPromiseFromCall\n  expect(updateCheckResult?.downloadPromise).toBeUndefined()\n\n  expect(actualEvents).toEqual(expectedEvents)\n})\n\ntest(\"github allowPrerelease=true\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.0.1\")\n  updater.allowPrerelease = true\n  updater.updateConfigPath = await writeUpdateConfig<GithubOptions>({\n    provider: \"github\",\n    owner: \"mmaietta\",\n    repo: \"electron-builder-test-prerelease\",\n  })\n  const updateCheckResult = await updater.checkForUpdates()\n  expect(removeUnstableProperties(updateCheckResult?.updateInfo)).toMatchSnapshot()\n})\n\ntest(\"github allowPrerelease=false\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.0.1\")\n  updater.allowPrerelease = false\n  updater.updateConfigPath = await writeUpdateConfig<GithubOptions>({\n    provider: \"github\",\n    owner: \"mmaietta\",\n    repo: \"electron-builder-test-prerelease\",\n  })\n  const updateCheckResult = await updater.checkForUpdates()\n  expect(removeUnstableProperties(updateCheckResult?.updateInfo)).toMatchSnapshot()\n})\n\ntest(\"github blockmap files - should get blockmap files\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.0.0\")\n  updater.updateConfigPath = await writeUpdateConfig<GithubOptions>({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n  })\n\n  await updater.checkForUpdates()\n\n  const provider = (updater as any)?.updateInfoAndProvider?.provider as GitHubProvider\n  if (provider) {\n    const oldVersion = \"1.1.9-2+ed8ccd\"\n    const newVersion = \"1.1.9-3+be4a1f\"\n    const baseUrlString = `https://github.com/artifacts/master/raw/electron%20Setup%20${newVersion}.exe`\n    const baseUrl = new URL(baseUrlString)\n\n    const blockMapUrls = await provider.getBlockMapFiles(baseUrl, oldVersion, newVersion)\n    const oldBlockMapUrl = blockMapUrls[0]\n    const newBlockMapUrl = blockMapUrls[1]\n\n    expect(oldBlockMapUrl.href).toBe(\"https://github.com/artifacts/master/raw/electron%20Setup%201.1.9-2+ed8ccd.exe.blockmap\")\n    expect(newBlockMapUrl.href).toBe(\"https://github.com/artifacts/master/raw/electron%20Setup%201.1.9-3+be4a1f.exe.blockmap\")\n  }\n})\n\ntest(\"file url generic\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  updater.updateConfigPath = await writeUpdateConfig<GenericServerOptions>({\n    provider: \"generic\",\n    url: \"https://develar.s3.amazonaws.com/test\",\n  })\n  await validateDownload(expect, updater)\n})\n\ntest.ifEnv(process.env.KEYGEN_TOKEN)(\"file url keygen\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  updater.addAuthHeader(`Bearer ${process.env.KEYGEN_TOKEN}`)\n  updater.updateConfigPath = await writeUpdateConfig<KeygenOptions>({\n    provider: \"keygen\",\n    product: process.env.KEYGEN_PRODUCT || \"43981278-96e7-47de-b8c2-98d59987206b\",\n    account: process.env.KEYGEN_ACCOUNT || \"cdecda36-3ef0-483e-ad88-97e7970f3149\",\n  })\n  await validateDownload(expect, updater)\n})\n\ntest.ifEnv(process.env.BITBUCKET_TOKEN)(\"file url bitbucket\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  const options: BitbucketOptions = {\n    provider: \"bitbucket\",\n    owner: \"mike-m\",\n    slug: \"electron-builder-test\",\n  }\n  updater.addAuthHeader(BitbucketPublisher.convertAppPassword(options.owner, process.env.BITBUCKET_TOKEN!))\n  updater.updateConfigPath = await writeUpdateConfig(options)\n  await validateDownload(expect, updater)\n})\n\ntest(\"file url gitlab\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  const options: GitlabOptions = {\n    provider: \"gitlab\",\n    projectId: 71361100,\n  }\n  updater.updateConfigPath = await writeUpdateConfig(options)\n  updater.signals.updateDownloaded(info => {\n    expect(info.downloadedFile).not.toBeNull()\n\n    delete (info as any).downloadedFile\n    expect(info).toMatchSnapshot()\n  })\n  await validateDownload(expect, updater)\n})\n\ntest(\"gitlab checkForUpdates\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig<GitlabOptions>({\n    provider: \"gitlab\",\n    projectId: 71361100,\n  })\n\n  const actualEvents: Array<string> = []\n  const expectedEvents = [\"checking-for-update\", \"update-available\"] as const\n  for (const eventName of expectedEvents) {\n    updater.addListener(eventName, () => {\n      actualEvents.push(eventName)\n    })\n  }\n\n  const updateCheckResult = await updater.checkForUpdates()\n  expect(removeUnstableProperties(updateCheckResult?.updateInfo)).toMatchSnapshot()\n  expect(actualEvents).toEqual(expectedEvents)\n})\n\ntest(\"gitlab - manual download\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig<GitlabOptions>({\n    provider: \"gitlab\",\n    projectId: 71361100,\n  })\n  updater.autoDownload = false\n\n  const actualEvents = trackEvents(updater)\n\n  const updateCheckResult = await updater.checkForUpdates()\n  expect(removeUnstableProperties(updateCheckResult?.updateInfo)).toMatchSnapshot()\n  // noinspection JSIgnoredPromiseFromCall\n  expect(updateCheckResult?.downloadPromise).toBeNull()\n  expect(actualEvents).toMatchSnapshot()\n\n  await assertThat(expect, path.join((await updater.downloadUpdate())[0])).isFile()\n})\n\ntest(\"gitlab blockmap files - should get blockmap files from project_upload\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.0.0\")\n  updater.updateConfigPath = await writeUpdateConfig<GitlabOptions>({\n    provider: \"gitlab\",\n    projectId: 71361100,\n    uploadTarget: \"project_upload\",\n  })\n\n  await updater.checkForUpdates()\n\n  const provider = (updater as any)?.updateInfoAndProvider?.provider as GitLabProvider\n  if (provider) {\n    const baseUrl = new URL(\"https://gitlab.com/gitlab-electron-updater-test_Setup_1.1.0.exe\")\n    const blockMapUrls = await provider.getBlockMapFiles(baseUrl, \"1.0.0\", \"1.1.0\")\n\n    expect(blockMapUrls).toHaveLength(2)\n\n    const oldBlockMapUrl = blockMapUrls[0]\n    const newBlockMapUrl = blockMapUrls[1]\n    expect(oldBlockMapUrl).toBeInstanceOf(URL)\n    expect(newBlockMapUrl).toBeInstanceOf(URL)\n    expect(oldBlockMapUrl.href).toContain(\"gitlab-electron-updater-test_Setup_1.0.0.exe.blockmap\")\n    expect(newBlockMapUrl.href).toContain(\"gitlab-electron-updater-test_Setup_1.1.0.exe.blockmap\")\n  }\n})\n\ntest(\"gitlab blockmap files - should get blockmap files from generic_package\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.0.0\")\n  updater.updateConfigPath = await writeUpdateConfig<GitlabOptions>({\n    provider: \"gitlab\",\n    projectId: 71361100,\n    uploadTarget: \"generic_package\",\n  })\n\n  await updater.checkForUpdates()\n\n  const provider = (updater as any)?.updateInfoAndProvider?.provider as GitLabProvider\n  if (provider) {\n    const baseUrl = new URL(\"https://gitlab.com/gitlab-electron-updater-test_Setup_1.1.0.exe\")\n    const blockMapUrls = await provider.getBlockMapFiles(baseUrl, \"1.0.0\", \"1.1.0\")\n\n    expect(blockMapUrls).toHaveLength(2)\n\n    const oldBlockMapUrl = blockMapUrls[0]\n    const newBlockMapUrl = blockMapUrls[1]\n    expect(oldBlockMapUrl).toBeInstanceOf(URL)\n    expect(newBlockMapUrl).toBeInstanceOf(URL)\n    expect(oldBlockMapUrl.href).toBe(\"https://gitlab.com/gitlab-electron-updater-test_Setup_1.0.0.exe.blockmap\")\n    expect(newBlockMapUrl.href).toBe(\"https://gitlab.com/gitlab-electron-updater-test_Setup_1.1.0.exe.blockmap\")\n  }\n})\n\ntest.skip(\"DigitalOcean Spaces\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  updater.updateConfigPath = await writeUpdateConfig<SpacesOptions>({\n    provider: \"spaces\",\n    name: \"electron-builder-test\",\n    path: \"light-updater-test\",\n    region: \"nyc3\",\n  })\n  await validateDownload(expect, updater)\n})\n\ntest.ifNotCiWin.skip(\"sha512 mismatch error event\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  updater.updateConfigPath = await writeUpdateConfig<GenericServerOptions>({\n    provider: \"generic\",\n    url: \"https://develar.s3.amazonaws.com/test\",\n    channel: \"beta\",\n  })\n\n  const actualEvents = trackEvents(updater)\n\n  const updateCheckResult = await updater.checkForUpdates()\n  expect(removeUnstableProperties(updateCheckResult?.updateInfo)).toMatchSnapshot()\n  await assertThat(expect, updateCheckResult?.downloadPromise).throws()\n\n  expect(actualEvents).toMatchSnapshot()\n})\n\ntest(\"file url generic - manual download\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  updater.updateConfigPath = await writeUpdateConfig<GenericServerOptions>({\n    provider: \"generic\",\n    url: \"https://develar.s3.amazonaws.com/test\",\n  })\n  updater.autoDownload = false\n\n  const actualEvents = trackEvents(updater)\n\n  const updateCheckResult = await updater.checkForUpdates()\n  expect(removeUnstableProperties(updateCheckResult?.updateInfo)).toMatchSnapshot()\n  // noinspection JSIgnoredPromiseFromCall\n  expect(updateCheckResult?.downloadPromise).toBeNull()\n  expect(actualEvents).toMatchSnapshot()\n\n  await assertThat(expect, path.join((await updater.downloadUpdate())[0])).isFile()\n})\n\n// https://github.com/electron-userland/electron-builder/issues/1045\ntest(\"checkForUpdates several times\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  updater.updateConfigPath = await writeUpdateConfig<GenericServerOptions>({\n    provider: \"generic\",\n    url: \"https://develar.s3.amazonaws.com/test\",\n  })\n\n  const actualEvents = trackEvents(updater)\n\n  for (let i = 0; i < 10; i++) {\n    //noinspection JSIgnoredPromiseFromCall\n    void updater.checkForUpdates()\n  }\n\n  async function checkForUpdates() {\n    const updateCheckResult = await updater.checkForUpdates()\n    expect(removeUnstableProperties(updateCheckResult?.updateInfo)).toMatchSnapshot()\n    await checkDownloadPromise(expect, updateCheckResult)\n  }\n\n  await checkForUpdates()\n  // we must not download the same file again\n  await checkForUpdates()\n\n  expect(actualEvents).toMatchSnapshot()\n})\n\nasync function checkDownloadPromise(expect: ExpectStatic, updateCheckResult: UpdateCheckResult | null) {\n  return await assertThat(expect, path.join((await updateCheckResult?.downloadPromise)![0])).isFile()\n}\n\ntest(\"file url github\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  const options: GithubOptions = {\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n  }\n  updater.updateConfigPath = await writeUpdateConfig(options)\n  updater.signals.updateDownloaded(info => {\n    expect(info.downloadedFile).not.toBeNull()\n\n    delete (info as any).downloadedFile\n    expect(info).toMatchSnapshot()\n  })\n  await validateDownload(expect, updater)\n})\n\ntest(\"file url github pre-release and fullChangelog\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.5.0-beta.1\")\n  const options: GithubOptions = {\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n  }\n  updater.fullChangelog = true\n  updater.updateConfigPath = await writeUpdateConfig(options)\n  updater.signals.updateDownloaded(info => {\n    expect(info.downloadedFile).not.toBeNull()\n\n    delete (info as any).downloadedFile\n    expect(info).toMatchSnapshot()\n  })\n  const updateCheckResult = await validateDownload(expect, updater)\n  expect(updateCheckResult?.updateInfo).toMatchSnapshot()\n})\n\ntest.ifEnv(process.env.GH_TOKEN || process.env.GITHUB_TOKEN)(\"file url github private\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig<GithubOptions>({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release_private\",\n    private: true,\n  })\n  await validateDownload(expect, updater)\n})\n\ntest(\"test error\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  const actualEvents = trackEvents(updater)\n\n  await assertThat(expect, updater.checkForUpdates()).throws()\n  expect(actualEvents).toMatchSnapshot()\n})\n\ntest.skip(\"test download progress\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n  })\n  updater.autoDownload = false\n\n  const progressEvents: Array<any> = []\n\n  updater.signals.progress(it => progressEvents.push(it))\n\n  await updater.checkForUpdates()\n  await updater.downloadUpdate()\n\n  expect(progressEvents.length).toBeGreaterThanOrEqual(1)\n\n  const lastEvent = progressEvents.pop()\n\n  expect(lastEvent.percent).toBe(100)\n  expect(lastEvent.bytesPerSecond).toBeGreaterThan(1)\n  expect(lastEvent.transferred).toBe(lastEvent.total)\n})\n\ntest(\"valid signature\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n    publisherName: [\"Vladimir Krivosheev\"],\n  })\n  await validateDownload(expect, updater)\n})\n\ntest(\"valid signature - multiple publisher DNs\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n    publisherName: [\"Foo Bar\", \"CN=Vladimir Krivosheev, O=Vladimir Krivosheev, L=Grunwald, S=Bayern, C=DE\", \"Bar Foo\"],\n  })\n  await validateDownload(expect, updater)\n})\n\ntest(\"valid signature using DN\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n    publisherName: [\"CN=Vladimir Krivosheev, O=Vladimir Krivosheev, L=Grunwald, S=Bayern, C=DE\"],\n  })\n\n  await validateDownload(expect, updater)\n})\n\ntest.ifWindows(\"invalid signature\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n    publisherName: [\"Foo Bar\"],\n  })\n  const actualEvents = trackEvents(updater)\n  await assertThat(\n    expect,\n    updater.checkForUpdates().then((it): any => it?.downloadPromise)\n  ).throws()\n  expect(actualEvents).toMatchSnapshot()\n})\n\ntest.ifWindows(\"test custom signature verifier\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.0.2\")\n  updater.updateConfigPath = await writeUpdateConfig<GithubOptions>({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n    publisherName: [\"CN=Vladimir Krivosheev, O=Vladimir Krivosheev, L=Grunwald, S=Bayern, C=DE\"],\n  })\n  updater.verifyUpdateCodeSignature = (publisherName: string[], path: string) => {\n    return Promise.resolve(null)\n  }\n  await validateDownload(expect, updater)\n})\n\ntest.ifWindows(\"test custom signature verifier - signing error message\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.0.2\")\n  updater.updateConfigPath = await writeUpdateConfig<GithubOptions>({\n    provider: \"github\",\n    owner: \"develar\",\n    repo: \"__test_nsis_release\",\n    publisherName: [\"CN=Vladimir Krivosheev, O=Vladimir Krivosheev, L=Grunwald, S=Bayern, C=DE\"],\n  })\n  updater.verifyUpdateCodeSignature = (publisherName: string[], path: string) => {\n    return Promise.resolve(\"signature verification failed\")\n  }\n  const actualEvents = trackEvents(updater)\n  await assertThat(\n    expect,\n    updater.checkForUpdates().then((it): any => it?.downloadPromise)\n  ).throws()\n  expect(actualEvents).toMatchSnapshot()\n})\n\n// disable for now\ntest(\"90 staging percentage\", config, async ({ expect }) => {\n  const userIdFile = path.join(tmpdir(), \"electron-updater-test\", \"userData\", \".updaterId\")\n  await outputFile(userIdFile, \"1wa70172-80f8-5cc4-8131-28f5e0edd2a1\")\n\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig<S3Options>({\n    provider: \"s3\",\n    channel: \"staging-percentage\",\n    bucket: \"develar\",\n    path: \"test\",\n  })\n  await validateDownload(expect, updater)\n})\n\ntest(\"1 staging percentage\", config, async ({ expect }) => {\n  const userIdFile = path.join(tmpdir(), \"electron-updater-test\", \"userData\", \".updaterId\")\n  await outputFile(userIdFile, \"12a70172-80f8-5cc4-8131-28f5e0edd2a1\")\n\n  const updater = await createNsisUpdater(\"0.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig({\n    provider: \"s3\",\n    channel: \"staging-percentage-small\",\n    bucket: \"develar\",\n    path: \"test\",\n  })\n  await validateDownload(expect, updater, false)\n})\n\ntest(\"cancel download with progress\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  updater.updateConfigPath = await writeUpdateConfig({\n    provider: \"generic\",\n    url: \"https://develar.s3.amazonaws.com/full-test\",\n  })\n\n  const progressEvents: Array<any> = []\n  updater.signals.progress(it => progressEvents.push(it))\n\n  let cancelled = false\n  updater.signals.updateCancelled(() => (cancelled = true))\n\n  const checkResult = await updater.checkForUpdates()\n  checkResult?.cancellationToken!.cancel()\n\n  if (progressEvents.length > 0) {\n    const lastEvent = progressEvents[progressEvents.length - 1]\n    expect(lastEvent.percent).not.toBe(100)\n    expect(lastEvent.bytesPerSecond).toBeGreaterThan(1)\n    expect(lastEvent.transferred).not.toBe(lastEvent.total)\n  }\n\n  const downloadPromise = checkResult?.downloadPromise\n  await assertThat(expect, downloadPromise).throws()\n  expect(cancelled).toBe(true)\n})\n\ntest(\"test download and install\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater()\n  updater.updateConfigPath = await writeUpdateConfig<GenericServerOptions>({\n    provider: \"generic\",\n    url: \"https://develar.s3.amazonaws.com/test\",\n  })\n\n  await validateDownload(expect, updater)\n})\n\ntest.ifWindows.skip(\"test downloaded installer\", config, async ({ expect }) => {\n  const updater = await createNsisUpdater(\"1.0.1\")\n  updater.updateConfigPath = await writeUpdateConfig<GithubOptions>({\n    provider: \"github\",\n    owner: \"mmaietta\",\n    repo: \"electron-builder-test\",\n  })\n\n  const actualEvents = trackEvents(updater)\n  await validateDownload(expect, updater)\n  // expect(actualEvents).toMatchObject([\"checking-for-update\", \"update-available\", \"update-downloaded\"])\n  updater.quitAndInstall(true, false)\n  expect(actualEvents).toMatchObject([\"checking-for-update\", \"update-available\", \"update-downloaded\", \"before-quit-for-update\"])\n})\n"]}