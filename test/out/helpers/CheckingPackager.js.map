{"version":3,"file":"CheckingPackager.js","sourceRoot":"","sources":["../../src/helpers/CheckingPackager.ts"],"names":[],"mappings":";;;AAGA,qDAAyE;AAKzE,6BAA4B;AAE5B,MAAa,mBAAoB,SAAQ,6BAAW;IAGlD,YAAY,IAAc;QACxB,KAAK,CAAC,IAAI,CAAC,CAAA;IACb,CAAC;IAED,mCAAmC;IACnC,KAAK,CAAC,IAAI,CAAC,MAAc,EAAE,IAAU,EAAE,OAAsB,EAAE,WAA6B;QAC1F,YAAY;QACZ,MAAM,WAAW,GAAiC,CAAC,2CAAa,mCAAmC,EAAC,CAAC,CAAC,OAAO,CAAA;QAC7G,MAAM,QAAQ,GAAG,IAAI,WAAW,CAAC,IAAI,EAAE,MAAM,CAAC,CAAA;QAC9C,MAAM,SAAS,GAAG,IAAI,CAAC,yBAAyB,CAAC,QAAQ,CAAC,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,wCAAwC,CAAC,CAAA;QACzH,MAAM,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,mBAAmB,IAAA,+BAAa,EAAC,IAAI,CAAC,EAAE,CAAC,CAAA;QACnF,IAAI,CAAC,oBAAoB,GAAG,MAAM,QAAQ,CAAC,2BAA2B,CAAC,eAAe,EAAE,MAAM,EAAE,SAAS,CAAC,CAAA;QAC1G,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,CAAA;IACxD,CAAC;IAED,mCAAmC;IACnC,4BAA4B,CAAC,SAAiB,EAAE,IAAU,EAAE,OAAsB,EAAE,WAA6B;QAC/G,OAAO;IACT,CAAC;CACF;AAtBD,kDAsBC;AAED,MAAa,mBAAoB,SAAQ,6BAAW;IAIlD,YAAY,IAAc;QACxB,KAAK,CAAC,IAAI,CAAC,CAAA;QAHb,yBAAoB,GAA0B,IAAI,CAAA;IAIlD,CAAC;IAED,KAAK,CAAC,IAAI,CAAC,MAAc,EAAE,IAAU,EAAE,OAAsB,EAAE,WAA6B;QAC1F,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE,CAAC;YAC7B,6CAA6C;YAC7C,IAAI,MAAM,CAAC,IAAI,KAAK,KAAK,EAAE,CAAC;gBAC1B,IAAI,CAAC,oBAAoB,GAAG,MAAO,MAAoB,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAA;gBACjF,MAAK;YACP,CAAC;QACH,CAAC;QACD,0EAA0E;QAC1E,OAAO,MAAM,6BAAW,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,WAAW,CAAC,CAAA;IACxF,CAAC;IAED,mCAAmC;IACnC,KAAK,CAAC,MAAM,CAAC,QAAyC;QACpD,OAAO;IACT,CAAC;IAED,oCAAoC;IACpC,KAAK,CAAC,MAAM,CAAC,IAAoB;QAC/B,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAA;QAChC,OAAO,OAAO,CAAC,OAAO,EAAE,CAAA;IAC1B,CAAC;IAED,yDAAyD;IACzD,KAAK,CAAC,MAAM,CAAC,OAAe,EAAE,OAAe,EAAE,QAAkB,EAAE,QAAwB;QACzF,OAAO;IACT,CAAC;IAED,yDAAyD;IACzD,4BAA4B,CAAC,SAAiB,EAAE,IAAU,EAAE,OAAsB,EAAE,WAA6B;QAC/G,OAAO;IACT,CAAC;IAES,KAAK,CAAC,eAAe,CAAC,SAAiB,EAAE,MAAc;QAC/D,UAAU;IACZ,CAAC;CACF;AA5CD,kDA4CC","sourcesContent":["import { SignOptions as MacSignOptions } from \"@electron/osx-sign/dist/cjs/types\"\nimport { Identity } from \"app-builder-lib/out/codeSign/macCodeSign\"\nimport { DoPackOptions } from \"app-builder-lib/out/platformPackager\"\nimport { WinPackager, getArchSuffix, MacPackager } from \"app-builder-lib\"\nimport { AsyncTaskManager } from \"builder-util\"\nimport { DmgTarget } from \"dmg-builder\"\nimport { Arch, MacConfiguration, Packager, Target } from \"electron-builder\"\nimport SquirrelWindowsTarget from \"electron-builder-squirrel-windows\"\nimport * as path from \"path\"\n\nexport class CheckingWinPackager extends WinPackager {\n  effectiveDistOptions: any\n\n  constructor(info: Packager) {\n    super(info)\n  }\n\n  //noinspection JSUnusedLocalSymbols\n  async pack(outDir: string, arch: Arch, targets: Array<Target>, taskManager: AsyncTaskManager): Promise<any> {\n    // skip pack\n    const helperClass: typeof SquirrelWindowsTarget = (await import(\"electron-builder-squirrel-windows\")).default\n    const newClass = new helperClass(this, outDir)\n    const setupFile = this.expandArtifactNamePattern(newClass.options, \"exe\", arch, \"${productName} Setup ${version}.${ext}\")\n    const installerOutDir = path.join(outDir, `squirrel-windows${getArchSuffix(arch)}`)\n    this.effectiveDistOptions = await newClass.computeEffectiveDistOptions(installerOutDir, outDir, setupFile)\n    await this.signIf(this.computeAppOutDir(outDir, arch))\n  }\n\n  //noinspection JSUnusedLocalSymbols\n  packageInDistributableFormat(appOutDir: string, arch: Arch, targets: Array<Target>, taskManager: AsyncTaskManager): void {\n    // skip\n  }\n}\n\nexport class CheckingMacPackager extends MacPackager {\n  effectiveDistOptions: any\n  effectiveSignOptions: MacSignOptions | null = null\n\n  constructor(info: Packager) {\n    super(info)\n  }\n\n  async pack(outDir: string, arch: Arch, targets: Array<Target>, taskManager: AsyncTaskManager): Promise<any> {\n    for (const target of targets) {\n      // do not use instanceof to avoid dmg require\n      if (target.name === \"dmg\") {\n        this.effectiveDistOptions = await (target as DmgTarget).computeDmgOptions(\"stub\")\n        break\n      }\n    }\n    // http://madole.xyz/babel-plugin-transform-async-to-module-method-gotcha/\n    return await MacPackager.prototype.pack.call(this, outDir, arch, targets, taskManager)\n  }\n\n  //noinspection JSUnusedLocalSymbols\n  async doPack(_options: DoPackOptions<MacConfiguration>) {\n    // skip\n  }\n\n  //noinspection JSUnusedGlobalSymbols\n  async doSign(opts: MacSignOptions): Promise<any> {\n    this.effectiveSignOptions = opts\n    return Promise.resolve()\n  }\n\n  //noinspection JSUnusedGlobalSymbols,JSUnusedLocalSymbols\n  async doFlat(appPath: string, outFile: string, identity: Identity, keychain?: string | null): Promise<any> {\n    // skip\n  }\n\n  //noinspection JSUnusedGlobalSymbols,JSUnusedLocalSymbols\n  packageInDistributableFormat(appOutDir: string, arch: Arch, targets: Array<Target>, taskManager: AsyncTaskManager): void {\n    // skip\n  }\n\n  protected async writeUpdateInfo(appOutDir: string, outDir: string) {\n    // ignored\n  }\n}\n"]}