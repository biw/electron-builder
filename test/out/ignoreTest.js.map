{"version":3,"file":"ignoreTest.js","sourceRoot":"","sources":["../src/ignoreTest.ts"],"names":[],"mappings":"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","sourcesContent":["import { DIR_TARGET, Platform, archFromString } from \"electron-builder\"\nimport { outputFile } from \"fs-extra\"\nimport * as path from \"path\"\nimport { assertThat } from \"./helpers/fileAssert\"\nimport { app, checkDirContents, linuxDirTarget, modifyPackageJson } from \"./helpers/packTester\"\nimport { PM } from \"app-builder-lib/out/node-module-collector/packageManager\"\n\nconst currentProcessTarget = Platform.LINUX.createTarget(DIR_TARGET, archFromString(process.arch))\n\ntest.ifDevOrLinuxCi(\"ignore build resources\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n      config: {\n        asar: false,\n      },\n    },\n    {\n      projectDirCreated: projectDir => {\n        return outputFile(path.join(projectDir, \"one/build/foo.txt\"), \"data\")\n      },\n      packed: context => {\n        return assertThat(expect, path.join(context.getResources(Platform.LINUX), \"app\", \"one\", \"build\", \"foo.txt\")).isFile()\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi(\"2 ignore\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n      config: {\n        asar: false,\n        files: [\n          \"**/*\",\n          \"!{app,build,electron,mobile,theme,uploads,util,dist,dist-app/aot,dist-app/app.bundle.js,dist-app/dependencies/shim.min.js,dist-app/dependencies/classList.min.js,dist-app/dependencies/web-animations.min.js,main.js,main-aot.js,favicon.ico,index.html,index-aot.html,index-cordova.html,index-aot.js,index-electron.js,index.bundle.js,systemjs.config.js,systemjs-angular-loader.js,package-lock.json}\",\n          \"!*config*.json\",\n          \"!**/*.{ts,scss,map,md,csv,wrapped}\",\n          \"!**/*.{hprof,orig,pyc,pyo,rbc}\",\n          \"!**/._*\",\n          \"!**/{.DS_Store,.git,.hg,.svn,CVS,RCS,SCCS,__pycache__,thumbs.db,.gitignore,.gitattributes,.flowconfig,.yarn-metadata.json,.idea,appveyor.yml,.travis.yml,circle.yml,npm-debug.log,.nyc_output,yarn.lock,.yarn-integrity}\",\n        ],\n      },\n    },\n    {\n      projectDirCreated: projectDir => {\n        return outputFile(path.join(projectDir, \"electron/foo.txt\"), \"data\")\n      },\n      packed: context => {\n        return assertThat(expect, path.join(context.getResources(Platform.LINUX), \"app\", \"electron\", \"foo.txt\")).doesNotExist()\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi(\"ignore known ignored files\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n      config: {\n        asar: false,\n      },\n    },\n    {\n      projectDirCreated: projectDir =>\n        Promise.all([\n          outputFile(path.join(projectDir, \".svn\", \"foo\"), \"data\"),\n          outputFile(path.join(projectDir, \".git\", \"foo\"), \"data\"),\n          outputFile(path.join(projectDir, \"node_modules\", \".bin\", \"f.txt\"), \"data\"),\n          outputFile(path.join(projectDir, \"node_modules\", \".bin2\", \"f.txt\"), \"data\"),\n        ]),\n      packed: context => checkDirContents(expect, path.join(context.getResources(Platform.LINUX), \"app\")),\n    }\n  )\n)\n\n// skip on macOS because we want test only / and \\\ntest.ifNotCiMac.sequential(\"ignore node_modules dev dep\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n      config: {\n        asar: false,\n        files: [\"**/*\", \"**/submodule-1-test/node_modules/**\"],\n      },\n    },\n    {\n      packageManager: PM.NPM,\n      projectDirCreated: async projectDir => {\n        return Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.devDependencies = {\n              semver: \"6.3.1\",\n              ...data.devDependencies,\n            }\n          }),\n        ])\n      },\n      packed: context => {\n        return Promise.all([assertThat(expect, path.join(context.getResources(Platform.LINUX), \"app\", \"node_modules\", \"semver\")).doesNotExist()])\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi.sequential(\"copied sub node_modules of the rootDir/node_modules\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: currentProcessTarget,\n      config: {\n        asar: false,\n        files: [\"**/*\", \"**/submodule-1-test/node_modules/**\"],\n      },\n    },\n    {\n      packageManager: PM.NPM,\n      projectDirCreated: async projectDir => {\n        return Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              \"electron-updater\": \"6.3.9\",\n              semver: \"6.3.1\",\n              ...data.dependencies,\n            }\n          }),\n          outputFile(path.join(projectDir, \"submodule-1-test\", \"node_modules\", \"package.json\"), \"{}\"),\n          outputFile(path.join(projectDir, \"others\", \"node_modules\", \"package.json\"), \"{}\"),\n        ])\n      },\n      packed: context => {\n        return Promise.all([\n          assertThat(\n            expect,\n            path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"node_modules\", \"electron-updater\", \"node_modules\")\n          ).isDirectory(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"others\", \"node_modules\")).doesNotExist(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"submodule-1-test\", \"node_modules\")).isDirectory(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"submodule-1-test\", \"node_modules\", \"package.json\")).isFile(),\n        ])\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi(\"Don't copy sub node_modules of the other dir instead of rootDir\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: currentProcessTarget,\n      config: {\n        asar: false,\n      },\n    },\n    {\n      projectDirCreated: projectDir => {\n        return Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              ...data.dependencies,\n            }\n          }),\n          outputFile(path.join(projectDir, \"others\", \"node_modules\", \"package.json\"), \"{}\"),\n          outputFile(path.join(projectDir, \"others\", \"test1\", \"package.json\"), \"{}\"),\n          outputFile(path.join(projectDir, \"others\", \"submodule-2-test\", \"node_modules\", \"package.json\"), \"{}\"),\n          outputFile(path.join(projectDir, \"others\", \"submodule-2-test\", \"test2\", \"package.json\"), \"{}\"),\n        ])\n      },\n      packed: context => {\n        return Promise.all([\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"others\", \"node_modules\")).doesNotExist(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"others\", \"test1\")).isDirectory(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"others\", \"test1\", \"package.json\")).isFile(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"others\", \"submodule-2-test\", \"node_modules\")).doesNotExist(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"others\", \"submodule-2-test\", \"test2\")).isDirectory(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"others\", \"submodule-2-test\", \"test2\", \"package.json\")).isFile(),\n        ])\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi(\"copied select submodule node_modules\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: currentProcessTarget,\n      config: {\n        asar: false,\n        // should use **/ instead of */,\n        // we use the related path to match, so the relative path is submodule-1-test/node_modules\n        // */ will not match submodule-1-test/node_modules\n        files: [\"**/*\", \"**/submodule-1-test/node_modules/**\"],\n      },\n    },\n    {\n      projectDirCreated: projectDir => {\n        return Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              ...data.dependencies,\n            }\n          }),\n          outputFile(path.join(projectDir, \"submodule-1-test\", \"node_modules\", \"package.json\"), \"{}\"),\n          outputFile(path.join(projectDir, \"submodule-2-test\", \"node_modules\", \"package.json\"), \"{}\"),\n        ])\n      },\n      packed: context => {\n        return Promise.all([\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"submodule-1-test\", \"node_modules\")).isDirectory(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"submodule-1-test\", \"node_modules\", \"package.json\")).isFile(),\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"submodule-2-test\", \"node_modules\")).doesNotExist(),\n        ])\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi(\"cannot copied select submodule node_modules by */\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: currentProcessTarget,\n      config: {\n        asar: false,\n        files: [\"**/*\", \"*/submodule-1-test/node_modules/**\"],\n      },\n    },\n    {\n      projectDirCreated: projectDir => {\n        return Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              ...data.dependencies,\n            }\n          }),\n          outputFile(path.join(projectDir, \"submodule-1-test\", \"node_modules\", \"package.json\"), \"{}\"),\n        ])\n      },\n      packed: context => {\n        return Promise.all([\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"submodule-1-test\", \"node_modules\")).doesNotExist(),\n        ])\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi(\"cannot copied select submodule node_modules by **/submodule-1-test/node_modules\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: currentProcessTarget,\n      config: {\n        asar: false,\n        files: [\"**/*\", \"**/submodule-1-test/node_modules\"],\n      },\n    },\n    {\n      projectDirCreated: projectDir => {\n        return Promise.all([\n          modifyPackageJson(projectDir, data => {\n            data.dependencies = {\n              ...data.dependencies,\n            }\n          }),\n          outputFile(path.join(projectDir, \"submodule-1-test\", \"node_modules\", \"package.json\"), \"{}\"),\n        ])\n      },\n      packed: context => {\n        return Promise.all([\n          assertThat(expect, path.join(context.getResources(Platform.LINUX, archFromString(process.arch)), \"app\", \"submodule-1-test\", \"node_modules\")).doesNotExist(),\n        ])\n      },\n    }\n  )\n)\n"]}