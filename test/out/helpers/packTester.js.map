{"version":3,"file":"packTester.js","sourceRoot":"","sources":["../../src/helpers/packTester.ts"],"names":[],"mappings":"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","sourcesContent":["import { PublishManager } from \"app-builder-lib\"\nimport { readAsar } from \"app-builder-lib/out/asar/asar\"\nimport { computeArchToTargetNamesMap } from \"app-builder-lib/out/targets/targetFactory\"\nimport { getLinuxToolsPath } from \"app-builder-lib/out/targets/tools\"\nimport { parsePlistFile, PlistObject } from \"app-builder-lib/out/util/plist\"\nimport { AsarIntegrity } from \"app-builder-lib/out/asar/integrity\"\nimport { addValue, copyDir, deepAssign, exec, executeFinally, exists, FileCopier, log, USE_HARD_LINKS, walk } from \"builder-util\"\nimport { CancellationToken, UpdateFileInfo } from \"builder-util-runtime\"\nimport { Arch, ArtifactCreated, Configuration, DIR_TARGET, getArchSuffix, MacOsTargetName, Packager, PackagerOptions, Platform, Target } from \"electron-builder\"\nimport { convertVersion } from \"electron-winstaller\"\nimport { PublishPolicy } from \"electron-publish\"\nimport { copyFile, emptyDir, mkdir, writeJson } from \"fs-extra\"\nimport * as fs from \"fs/promises\"\nimport { load } from \"js-yaml\"\nimport * as path from \"path\"\nimport pathSorter from \"path-sort\"\nimport { NtExecutable, NtExecutableResource } from \"resedit\"\nimport { TmpDir } from \"temp-file\"\nimport { getCollectorByPackageManager, PM } from \"app-builder-lib/out/node-module-collector\"\nimport { promisify } from \"util\"\nimport { CSC_LINK, WIN_CSC_LINK } from \"./codeSignData\"\nimport { assertThat } from \"./fileAssert\"\nimport AdmZip from \"adm-zip\"\n// @ts-ignore\nimport sanitizeFileName from \"sanitize-filename\"\nimport type { ExpectStatic } from \"vitest\"\nimport { computeDefaultAppDirectory } from \"app-builder-lib/out/util/config/config\"\nimport { installDependencies } from \"app-builder-lib/out/util/yarn\"\nimport { ELECTRON_VERSION } from \"./testConfig\"\nimport { createLazyProductionDeps } from \"app-builder-lib/out/util/packageDependencies\"\nimport { execSync } from \"child_process\"\nimport { detectPackageManager } from \"app-builder-lib/out/node-module-collector/packageManager\"\n\nconst PACKAGE_MANAGER_VERSION_MAP = {\n  [PM.NPM]: { cli: \"npm\", version: \"9.8.1\" },\n  [PM.YARN]: { cli: \"yarn\", version: \"1.22.19\" },\n  [PM.YARN_BERRY]: { cli: \"yarn\", version: \"3.5.0\" },\n  [PM.PNPM]: { cli: \"pnpm\", version: \"10.18.0\" },\n  [PM.BUN]: { cli: \"bun\", version: \"1.3.2\" },\n}\n\nexport function getPackageManagerWithVersion(pm: PM, packageManagerAndVersionString?: string) {\n  const packageManagerInfo = PACKAGE_MANAGER_VERSION_MAP[pm]\n  const prepare = packageManagerAndVersionString == null ? `${packageManagerInfo.cli}@${packageManagerInfo.version}` : packageManagerAndVersionString\n  return {\n    cli: packageManagerInfo.cli,\n    version: packageManagerInfo.version,\n    prepareEntry: prepare,\n  }\n}\n\nexport const EXTENDED_TIMEOUT = 14 * 60 * 1000\nexport const linuxDirTarget = Platform.LINUX.createTarget(DIR_TARGET, Arch.x64)\nexport const snapTarget = Platform.LINUX.createTarget(\"snap\", Arch.x64)\n\nexport interface AssertPackOptions {\n  readonly projectDirCreated?: (projectDir: string, tmpDir: TmpDir) => Promise<any> | (() => Promise<any>)\n  readonly packed?: (context: PackedContext) => Promise<any>\n  readonly expectedArtifacts?: Array<string>\n\n  readonly checkMacApp?: (appDir: string, info: any) => Promise<any>\n\n  readonly packageManager?: PM\n  readonly useTempDir?: boolean\n  readonly signed?: boolean\n  readonly signedWin?: boolean\n\n  readonly storeDepsLockfileSnapshot?: boolean\n\n  readonly publish?: PublishPolicy\n\n  readonly tmpDir?: TmpDir\n}\n\nexport interface PackedContext {\n  readonly projectDir: string\n  readonly outDir: string\n\n  readonly getAppPath: (platform: Platform, arch?: Arch) => string\n  readonly getResources: (platform: Platform, arch?: Arch) => string\n  readonly getContent: (platform: Platform, arch?: Arch) => string\n\n  readonly packager: Packager\n\n  readonly tmpDir: TmpDir\n}\n\nexport function appThrows(expect: ExpectStatic, packagerOptions: PackagerOptions, checkOptions: AssertPackOptions = {}, customErrorAssert?: (error: Error) => void) {\n  return assertThat(expect, assertPack(expect, \"test-app-one\", packagerOptions, checkOptions)).throws(customErrorAssert)\n}\n\nexport function appTwoThrows(expect: ExpectStatic, packagerOptions: PackagerOptions, checkOptions: AssertPackOptions = {}, customErrorAssert?: (error: Error) => void) {\n  return assertThat(expect, assertPack(expect, \"test-app\", packagerOptions, checkOptions)).throws(customErrorAssert)\n}\n\nexport function app(expect: ExpectStatic, packagerOptions: PackagerOptions, checkOptions: AssertPackOptions = {}) {\n  return assertPack(expect, packagerOptions.config != null && (packagerOptions.config as any).protonNodeVersion != null ? \"proton\" : \"test-app-one\", packagerOptions, checkOptions)\n}\n\nexport function appTwo(expect: ExpectStatic, packagerOptions: PackagerOptions, checkOptions: AssertPackOptions = {}) {\n  return assertPack(expect, \"test-app\", packagerOptions, checkOptions)\n}\n\nexport async function assertPack(expect: ExpectStatic, fixtureName: string, packagerOptions: PackagerOptions, checkOptions: AssertPackOptions = {}): Promise<void> {\n  let configuration = packagerOptions.config as Configuration\n  if (configuration == null) {\n    configuration = {}\n    ;(packagerOptions as any).config = configuration\n  }\n\n  if (checkOptions.signed) {\n    packagerOptions = signed(packagerOptions)\n  }\n  if (checkOptions.signedWin) {\n    configuration.cscLink = WIN_CSC_LINK\n    configuration.cscKeyPassword = \"\"\n  } else if (configuration.cscLink == null) {\n    packagerOptions = deepAssign({}, packagerOptions, { config: { mac: { identity: null } } })\n  }\n\n  let projectDir = path.join(__dirname, \"..\", \"..\", \"fixtures\", fixtureName)\n  // const isDoNotUseTempDir = platform === \"darwin\"\n  const customTmpDir = process.env.TEST_APP_TMP_DIR\n  const tmpDir = checkOptions.tmpDir || new TmpDir(`pack-tester: ${fixtureName}`)\n  // non-macOS test uses the same dir as macOS test, but we cannot share node_modules (because tests executed in parallel)\n  const dir = customTmpDir == null ? await tmpDir.createTempDir({ prefix: \"test-project\" }) : path.resolve(customTmpDir)\n  if (customTmpDir != null) {\n    await emptyDir(dir)\n    log.info({ customTmpDir }, \"custom temp dir used\")\n  }\n\n  const state = expect.getState()\n  const lockfileFixtureName = `${path.basename(state.testPath!, \".ts\")}`\n  const lockfilePathPrefix = path.join(__dirname, \"..\", \"..\", \"fixtures\", \"lockfiles\", lockfileFixtureName)\n  const testFixtureLockfile = path.join(lockfilePathPrefix, `${sanitizeFileName(state.currentTestName!)}.txt`)\n\n  await copyDir(projectDir, dir, {\n    filter: it => {\n      const basename = path.basename(it)\n      // if custom project dir specified, copy node_modules (i.e. do not ignore it)\n      return (packagerOptions.projectDir != null || basename !== \"node_modules\") && (!basename.startsWith(\".\") || basename === \".babelrc\")\n    },\n    isUseHardLink: USE_HARD_LINKS, // TODO: consider use hard links for tests\n  })\n  projectDir = dir\n\n  await executeFinally(\n    (async () => {\n      const packageManagerOverride = checkOptions.packageManager\n      await modifyPackageJson(projectDir, data => {\n        if (data.packageManager == null || packageManagerOverride) {\n          data.packageManager = getPackageManagerWithVersion(packageManagerOverride || PM.NPM).prepareEntry\n        }\n      })\n\n      const postNodeModulesInstallHook = checkOptions.projectDirCreated ? await checkOptions.projectDirCreated(projectDir, tmpDir) : null\n\n      // Check again. Package manager could have been changed in package.json during `projectDirCreated`\n      const { pm, corepackConfig: packageManager } = await detectPackageManager([projectDir])\n\n      const tmpCache = await tmpDir.createTempDir({ prefix: \"cache-\" })\n      const tmpHome = await tmpDir.createTempDir({ prefix: \"home-\" })\n      const runtimeEnv = {\n        ...process.env,\n        // corepack\n        // COREPACK_HOME,\n        // COREPACK_ENABLE_DOWNLOADS: \"1\",\n        // yarn\n        HOME: tmpHome,\n        USERPROFILE: tmpHome, // for Windows compatibility\n        YARN_CACHE_FOLDER: tmpCache,\n        // YARN_DISABLE_TELEMETRY: \"1\",\n        // YARN_ENABLE_TELEMETRY: \"false\",\n        YARN_IGNORE_PATH: \"1\", // ignore globally installed yarn binaries\n        YARN_ENABLE_IMMUTABLE_INSTALLS: \"false\", // to be sure that --frozen-lockfile is not used\n        // YARN_NODE_LINKER: \"node-modules\", // force to not use pnp (as there's no way to access virtual packages within the paths returned by pnpm)\n        npm_config_cache: tmpCache, // prevent npm fallback caching\n      }\n      const { cli, prepareEntry, version } = getPackageManagerWithVersion(pm, packageManager)\n      if (pm === PM.BUN) {\n        log.info({ pm, version: version, projectDir }, \"installing dependencies with bun; corepack does not support it currently and it must be installed separately\")\n      } else if (pm === PM.NPM) {\n        // npm is already installed as part of Node.js, so we just need to prepare the specific version\n        // Skip `corepack enable npm` to avoid race conditions in parallel tests (EEXIST errors)\n        log.info({ pm, version: version, projectDir }, \"preparing npm version via corepack\")\n        try {\n          execSync(`corepack prepare ${prepareEntry} --activate`, { env: runtimeEnv, cwd: projectDir, stdio: \"inherit\" })\n        } catch (err: any) {\n          console.warn(\"⚠️ Corepack prepare npm failed:\", err.message)\n        }\n      } else {\n        log.info({ pm, version: version, projectDir }, \"activating corepack\")\n        try {\n          execSync(`corepack enable ${cli}`, { env: runtimeEnv, cwd: projectDir, stdio: \"inherit\" })\n        } catch (err: any) {\n          console.warn(\"⚠️ Corepack enable failed (possibly already enabled):\", err.message)\n        }\n        try {\n          execSync(`corepack prepare ${prepareEntry} --activate`, { env: runtimeEnv, cwd: projectDir, stdio: \"inherit\" })\n        } catch (err: any) {\n          console.warn(\"⚠️ Corepack prepare failed:\", err.message)\n        }\n      }\n      const collector = getCollectorByPackageManager(pm, projectDir, tmpDir)\n      const collectorOptions = collector.installOptions\n\n      const destLockfile = path.join(projectDir, collectorOptions.lockfile)\n\n      const shouldUpdateLockfiles = !!process.env.UPDATE_LOCKFILE_FIXTURES && !!checkOptions.storeDepsLockfileSnapshot\n      // check for lockfile fixture so we can use `--frozen-lockfile`\n      if ((await exists(testFixtureLockfile)) && !shouldUpdateLockfiles) {\n        await copyFile(testFixtureLockfile, destLockfile)\n      }\n\n      const appDir = await computeDefaultAppDirectory(projectDir, configuration.directories?.app)\n\n      await installDependencies(\n        configuration,\n        {\n          projectDir: projectDir,\n          appDir: appDir,\n          workspaceRoot: null,\n        },\n        {\n          frameworkInfo: { version: ELECTRON_VERSION, useCustomDist: false },\n          productionDeps: createLazyProductionDeps(appDir, null, false),\n        },\n        runtimeEnv\n      )\n\n      if (typeof postNodeModulesInstallHook === \"function\") {\n        await postNodeModulesInstallHook()\n      }\n\n      // save lockfile fixture\n      if (!(await exists(testFixtureLockfile)) && shouldUpdateLockfiles) {\n        const fixtureDir = path.dirname(testFixtureLockfile)\n        if (!(await exists(fixtureDir))) {\n          await mkdir(fixtureDir)\n        }\n        await copyFile(destLockfile, testFixtureLockfile)\n      }\n\n      if (packagerOptions.projectDir != null) {\n        packagerOptions.projectDir = path.resolve(projectDir, packagerOptions.projectDir)\n      }\n\n      const { packager, outDir } = await packAndCheck(\n        expect,\n        {\n          projectDir,\n          ...packagerOptions,\n        },\n        checkOptions,\n        runtimeEnv\n      )\n\n      if (checkOptions.packed != null) {\n        const getAppPath = function (platform: Platform, arch?: Arch): string {\n          return path.join(outDir, `${platform.buildConfigurationKey}${getArchSuffix(arch ?? Arch.x64)}${platform === Platform.MAC ? \"\" : \"-unpacked\"}`)\n        }\n        const getContent = (platform: Platform, arch: Arch | undefined): string => {\n          return path.join(getAppPath(platform, arch), platform === Platform.MAC ? `${packager.appInfo.productFilename}.app/Contents` : \"\")\n        }\n        const getResources = (platform: Platform, arch: Arch | undefined): string => {\n          return path.join(getContent(platform, arch), platform === Platform.MAC ? \"Resources\" : \"resources\")\n        }\n        await checkOptions.packed({\n          projectDir,\n          outDir,\n          getAppPath,\n          getResources,\n          getContent,\n          packager,\n          tmpDir,\n        })\n      }\n    })(),\n    (): any => (tmpDir === checkOptions.tmpDir ? null : tmpDir.cleanup())\n  )\n}\n\nconst fileCopier = new FileCopier()\n\nexport function copyTestAsset(name: string, destination: string): Promise<void> {\n  return fileCopier.copy(path.join(getFixtureDir(), name), destination, undefined)\n}\n\nexport function getFixtureDir() {\n  return path.join(__dirname, \"..\", \"..\", \"fixtures\")\n}\n\n/**\n * Determines the priority of a file based on its extension for sorting.\n * Lower numbers have higher priority in the sort order.\n */\nfunction getFileTypePriority(file: string): number {\n  const ordering = [\n    // Primary executables and installers\n    \".dmg\",\n    \".exe\",\n    \".msi\",\n    \".pkg\",\n    \".deb\",\n    \".rpm\",\n    \".AppImage\",\n    \".appx\",\n    \".snap\",\n    \".flatpak\",\n\n    // Archive formats\n    \".zip\",\n    \".7z\",\n    \".tar.gz\",\n    \".tar.xz\",\n    \".tar.bz2\",\n\n    // Package formats\n    \".nupkg\",\n    \".asar\",\n\n    // Metadata and auxiliary files\n    \".blockmap\",\n    \".yml\",\n    \".yaml\",\n  ]\n\n  const index = ordering.findIndex(ext => file.endsWith(ext))\n  // If found, return the index (0-based), otherwise return highest value for \"other files\"\n  return index === -1 ? ordering.length : index\n}\n\n/**\n * Sorts artifacts in a deterministic order for consistent test snapshots.\n * Sort order:\n * 1. Primary: File type (by extension priority)\n * 2. Secondary: Architecture (ia32 < x64 < armv7l < arm64 < universal)\n * 3. Tertiary: Filename (alphabetical)\n * 4. Quaternary: Presence of updateInfo (with updateInfo < without updateInfo)\n * 5. Quinary: Safe artifact name (alphabetical)\n */\nfunction sortArtifacts(a: ArtifactCreated, b: ArtifactCreated): number {\n  // Primary sort: by file extension type\n  const fileA = a.file ?? \"\"\n  const fileB = b.file ?? \"\"\n\n  const typePriorityA = getFileTypePriority(fileA)\n  const typePriorityB = getFileTypePriority(fileB)\n\n  if (typePriorityA !== typePriorityB) {\n    return typePriorityA - typePriorityB\n  }\n\n  // Secondary sort: by architecture\n  const archSortKey = (a.arch?.valueOf() ?? 0) - (b.arch?.valueOf() ?? 0)\n  if (archSortKey !== 0) {\n    return archSortKey\n  }\n\n  // Tertiary sort: by filename\n  const baseNameA = path.basename(fileA)\n  const baseNameB = path.basename(fileB)\n  const fileNameCompare = baseNameA.localeCompare(baseNameB, \"en\")\n  if (fileNameCompare !== 0) {\n    return fileNameCompare\n  }\n\n  // Quaternary sort: by presence of updateInfo (with updateInfo comes first)\n  const hasUpdateInfoA = a.updateInfo ? 0 : 1\n  const hasUpdateInfoB = b.updateInfo ? 0 : 1\n\n  if (hasUpdateInfoA !== hasUpdateInfoB) {\n    return hasUpdateInfoA - hasUpdateInfoB\n  }\n\n  // Quinary sort: by safeArtifactName (final tiebreaker)\n  const safeNameA = a.safeArtifactName ?? \"\"\n  const safeNameB = b.safeArtifactName ?? \"\"\n\n  return safeNameA.localeCompare(safeNameB, \"en\")\n}\n\nasync function packAndCheck(\n  expect: ExpectStatic,\n  packagerOptions: PackagerOptions,\n  checkOptions: AssertPackOptions,\n  runtimeEnv: NodeJS.ProcessEnv\n): Promise<{ packager: Packager; outDir: string }> {\n  const cancellationToken = new CancellationToken()\n  const packager = new Packager(packagerOptions, cancellationToken)\n  ;(packager as any).runtimeEnvironmentVariables = runtimeEnv\n  const publishManager = new PublishManager(packager, { publish: \"publish\" in checkOptions ? checkOptions.publish : \"never\" })\n\n  const artifacts: Map<Platform, Array<ArtifactCreated>> = new Map()\n  packager.onArtifactCreated(event => {\n    if (event.file == null) {\n      return\n    }\n\n    assertThat(expect, event.file).isAbsolute()\n    addValue(artifacts, event.packager.platform, event)\n  })\n\n  const { outDir, platformToTargets } = await packager.build()\n  await publishManager.awaitTasks()\n\n  if (packagerOptions.platformPackagerFactory != null) {\n    return { packager, outDir }\n  }\n\n  const objectToCompare: any = {}\n  for (const platform of packagerOptions.targets!.keys()) {\n    objectToCompare[platform.buildConfigurationKey] = await Promise.all(\n      (artifacts.get(platform) || []).sort(sortArtifacts).map(async it => {\n        const result: any = { ...it }\n        const file = result.file\n        if (file != null) {\n          if (file.endsWith(\".yml\")) {\n            result.fileContent = removeUnstableProperties(load(await fs.readFile(file, \"utf-8\")))\n          }\n          result.file = path.basename(file)\n        }\n        const updateInfo = result.updateInfo\n        if (updateInfo != null) {\n          result.updateInfo = removeUnstableProperties(updateInfo)\n        }\n        if (updateInfo == null) {\n          delete result.updateInfo\n        }\n\n        // reduce snapshot - avoid noise\n        if (result.safeArtifactName == null) {\n          delete result.safeArtifactName\n        }\n        if (result.arch == null) {\n          delete result.arch\n        } else {\n          result.arch = Arch[result.arch]\n        }\n\n        if (result.fileContent) {\n          if (Buffer.isBuffer(result.fileContent)) {\n            delete result.fileContent\n          } else if (Array.isArray(result.fileContent.files)) {\n            result.fileContent.files = result.fileContent.files.sort((a: UpdateFileInfo, b: UpdateFileInfo) => a.url.localeCompare(b.url, \"en\"))\n          }\n        }\n\n        delete result.isWriteUpdateInfo\n        delete result.packager\n        delete result.target\n        delete result.publishConfig\n        return result\n      })\n    )\n  }\n\n  expect(objectToCompare).toMatchSnapshot()\n\n  c: for (const [platform, archToType] of packagerOptions.targets!) {\n    for (const [arch, targets] of computeArchToTargetNamesMap(\n      archToType,\n      { platformSpecificBuildOptions: (packagerOptions as any)[platform.buildConfigurationKey] || {}, defaultTarget: [] } as any,\n      platform\n    )) {\n      if (targets.length === 1 && targets[0] === DIR_TARGET) {\n        continue c\n      }\n\n      const nameToTarget = platformToTargets.get(platform)!\n      if (platform === Platform.MAC) {\n        const subDir = nameToTarget.has(\"mas-dev\") ? \"mas-dev\" : nameToTarget.has(\"mas\") ? \"mas\" : \"mac\"\n        const packedAppDir = path.join(outDir, `${subDir}${getArchSuffix(arch)}`, `${packager.appInfo.productFilename}.app`)\n        await checkMacResult(expect, packager, packagerOptions, checkOptions, packedAppDir)\n      } else if (platform === Platform.LINUX) {\n        await checkLinuxResult(expect, outDir, packager, arch, nameToTarget)\n      } else if (platform === Platform.WINDOWS) {\n        await checkWindowsResult(expect, packager, checkOptions, artifacts.get(platform)!, nameToTarget)\n      }\n    }\n  }\n\n  return { packager, outDir }\n}\n\nasync function checkLinuxResult(expect: ExpectStatic, outDir: string, packager: Packager, arch: Arch, nameToTarget: Map<string, Target>) {\n  if (!nameToTarget.has(\"deb\")) {\n    return\n  }\n\n  const appInfo = packager.appInfo\n  const autoFindPackagePath = await fs.readdir(outDir).then(files => files.find(file => file.endsWith(\".deb\")))\n  const defaultPackageFile = `${outDir}/${appInfo.name}_${appInfo.version}_${arch === Arch.ia32 ? \"i386\" : arch === Arch.x64 ? \"amd64\" : \"armv7l\"}.deb`\n  const packagePath = autoFindPackagePath != null ? path.join(outDir, autoFindPackagePath) : defaultPackageFile\n  expect(await getContents(packagePath)).toMatchSnapshot()\n  if (arch === Arch.ia32) {\n    expect(await getContents(`${outDir}/${appInfo.name}_${appInfo.version}_i386.deb`)).toMatchSnapshot()\n  }\n\n  const control = parseDebControl(\n    (\n      await execShell(`ar p '${packagePath}' control.tar.xz | ${await getTarExecutable()} -Jx --to-stdout ./control`, {\n        maxBuffer: 10 * 1024 * 1024,\n      })\n    ).stdout\n  )\n\n  delete control.Version\n  delete control.Size\n  const description = control.Description\n  delete control.Description\n  expect(control).toMatchSnapshot()\n  // strange difference on linux and mac (no leading space on Linux)\n  expect(description.trim()).toMatchSnapshot()\n}\n\nfunction parseDebControl(info: string): any {\n  const regexp = /([\\w]+): *(.+\\n)([^:\\n]+\\n)?/g\n  let match: Array<string> | null\n  const metadata: any = {}\n  info = info.substring(info.indexOf(\"Package:\"))\n  while ((match = regexp.exec(info)) !== null) {\n    let value = match[2]\n    if (match[3] != null) {\n      value += match[3]\n    }\n\n    if (value[value.length - 1] === \"\\n\") {\n      value = value.substring(0, value.length - 1)\n    }\n    metadata[match[1]] = value\n  }\n  return metadata\n}\n\nasync function checkMacResult(expect: ExpectStatic, packager: Packager, packagerOptions: PackagerOptions, checkOptions: AssertPackOptions, packedAppDir: string) {\n  const appInfo = packager.appInfo\n  const plistPath = path.join(packedAppDir, \"Contents\", \"Info.plist\")\n  const info = await parsePlistFile<PlistObject>(plistPath)\n\n  const buildNumber = process.env.TRAVIS_BUILD_NUMBER || process.env.CIRCLE_BUILD_NUM\n  expect(info).toMatchObject({\n    CFBundleVersion: info.CFBundleVersion === \"50\" ? \"50\" : `${appInfo.version}${buildNumber ? \".\" + buildNumber : \"\"}`,\n  })\n\n  // checked manually, remove to avoid mismatch on CI server (where TRAVIS_BUILD_NUMBER is defined and different on each test run)\n  delete info.CFBundleVersion\n  delete info.BuildMachineOSBuild\n  delete info.NSHumanReadableCopyright\n  delete info.DTXcode\n  delete info.DTXcodeBuild\n  delete info.DTSDKBuild\n  delete info.DTSDKName\n  delete info.DTCompiler\n  delete info.ElectronTeamID\n  delete info.NSMainNibFile\n  delete info.NSCameraUsageDescription\n  delete info.NSMicrophoneUsageDescription\n  delete info.NSRequiresAquaSystemAppearance\n  delete info.NSQuitAlwaysKeepsWindows\n  if (info.NSAppTransportSecurity != null) {\n    delete (info.NSAppTransportSecurity as PlistObject).NSAllowsArbitraryLoads\n  }\n  // test value\n  if (info.LSMinimumSystemVersion !== \"10.12.0\") {\n    delete info.LSMinimumSystemVersion\n  }\n\n  const { ElectronAsarIntegrity: checksumData, ...snapshot } = info\n\n  if (checksumData != null) {\n    for (const name of Object.keys(checksumData)) {\n      ;(checksumData as Record<string, any>)[name] = { algorithm: \"SHA256\", hash: \"hash\" }\n    }\n    snapshot.ElectronAsarIntegrity = checksumData\n  }\n  expect(snapshot).toMatchSnapshot()\n\n  if (checkOptions.checkMacApp != null) {\n    await checkOptions.checkMacApp(packedAppDir, snapshot)\n  }\n\n  if (packagerOptions.config != null && (packagerOptions.config as Configuration).cscLink != null) {\n    const result = await exec(\"codesign\", [\"--verify\", packedAppDir])\n    expect(result).not.toMatch(/is not signed at all/)\n  }\n}\n\nasync function checkWindowsResult(expect: ExpectStatic, packager: Packager, checkOptions: AssertPackOptions, artifacts: Array<ArtifactCreated>, nameToTarget: Map<string, Target>) {\n  function checkSquirrelResult() {\n    const appInfo = packager.appInfo\n    const { zip } = checkResult(expect, artifacts, \"-full.nupkg\")\n\n    if (checkOptions == null) {\n      const expectedSpec = zip.readAsText(\"TestApp.nuspec\").replace(/\\r\\n/g, \"\\n\")\n      // console.log(expectedSpec)\n      expect(expectedSpec).toEqual(`<?xml version=\"1.0\"?>\n<package xmlns=\"http://schemas.microsoft.com/packaging/2011/08/nuspec.xsd\">\n  <metadata>\n    <id>TestApp</id>\n    <version>${convertVersion(appInfo.version)}</version>\n    <title>${appInfo.productName}</title>\n    <authors>Foo Bar</authors>\n    <owners>Foo Bar</owners>\n    <iconUrl>https://raw.githubusercontent.com/szwacz/electron-boilerplate/master/resources/windows/icon.ico</iconUrl>\n    <requireLicenseAcceptance>false</requireLicenseAcceptance>\n    <description>Test Application (test quite “ #378)</description>\n    <copyright>Copyright © ${new Date().getFullYear()} Foo Bar</copyright>\n    <projectUrl>http://foo.example.com</projectUrl>\n  </metadata>\n</package>`)\n    }\n  }\n\n  async function checkZipResult() {\n    const { packageFile, zip, allFiles } = checkResult(expect, artifacts, \".zip\")\n\n    const executable = allFiles.filter(it => it.endsWith(\".exe\"))[0]\n    zip.extractEntryTo(executable, path.dirname(packageFile), true, true)\n    const buffer = await fs.readFile(path.join(path.dirname(packageFile), executable))\n    const resource = NtExecutableResource.from(NtExecutable.from(buffer))\n    const integrityBuffer = resource.entries.find(entry => entry.type === \"INTEGRITY\")\n    const asarIntegrity = new Uint8Array(integrityBuffer!.bin)\n    const decoder = new TextDecoder(\"utf-8\")\n    const checksumData = decoder.decode(asarIntegrity)\n    const checksums = JSON.parse(checksumData).map((data: AsarIntegrity) => ({ ...data, alg: \"SHA256\", value: \"hash\" }))\n    expect(checksums).toMatchSnapshot()\n  }\n\n  const hasTarget = (target: string) => {\n    const targets = nameToTarget.get(target)\n    return targets != null\n  }\n  if (hasTarget(\"squirrel\")) {\n    return checkSquirrelResult()\n  } else if (hasTarget(\"zip\") && !(checkOptions.signed || checkOptions.signedWin)) {\n    return checkZipResult()\n  }\n}\n\nconst checkResult = (expect: ExpectStatic, artifacts: Array<ArtifactCreated>, extension: string) => {\n  const packageFile = artifacts.find(it => it.file.endsWith(extension))!.file\n\n  const zip = new AdmZip(packageFile)\n  const zipEntries = zip.getEntries()\n  const allFiles: string[] = []\n  // https://github.com/thejoshwolfe/yauzl/blob/master/index.js#L900\n  const cp437 =\n    \"\\u0000☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ \"\n  const decodeBuffer = (buffer: Buffer, isUtf8: boolean) => {\n    if (isUtf8) {\n      return buffer.toString(\"utf8\")\n    } else {\n      let result = \"\"\n      for (let i = 0; i < buffer.length; i++) {\n        result += cp437[buffer[i]]\n      }\n      return result\n    }\n  }\n\n  zipEntries.forEach(function (zipEntry) {\n    const isUtf8 = (zipEntry.header.flags & 0x800) !== 0\n    const name = decodeBuffer(zipEntry.rawEntryName, isUtf8)\n    allFiles.push(name)\n  })\n\n  // we test app-update.yml separately, don't want to complicate general assert (yes, it is not good that we write app-update.yml for squirrel.windows if we build nsis and squirrel.windows in parallel, but as squirrel.windows is deprecated, it is ok)\n  const files = pathSorter(\n    allFiles\n      .map(it => toSystemIndependentPath(it))\n      .filter(\n        it =>\n          (!it.startsWith(\"lib/net45/locales/\") || it === \"lib/net45/locales/en-US.pak\") && !it.endsWith(\".psmdcp\") && !it.endsWith(\"app-update.yml\") && !it.includes(\"/inspector/\")\n      )\n  )\n\n  expect(files).toMatchSnapshot()\n\n  return { packageFile, zip, allFiles }\n}\n\nexport const execShell: any = promisify(require(\"child_process\").exec)\n\nexport async function getTarExecutable() {\n  return process.platform === \"darwin\" ? path.join(await getLinuxToolsPath(), \"bin\", \"gtar\") : \"tar\"\n}\n\nasync function getContents(packageFile: string) {\n  const result = await execShell(`ar p '${packageFile}' data.tar.xz | ${await getTarExecutable()} -tJ`, {\n    maxBuffer: 10 * 1024 * 1024,\n    env: {\n      ...process.env,\n    },\n  })\n\n  const contents = parseFileList(result.stdout, true)\n  return pathSorter(contents.filter(it => !(it.includes(`/locales/`) || it.includes(`/libgcrypt`) || it.includes(\"/inspector/\"))))\n}\n\nexport function parseFileList(data: string, fromDpkg: boolean): Array<string> {\n  return data\n    .split(\"\\n\")\n    .map(it => (it.length === 0 ? null : fromDpkg ? it.substring(it.indexOf(\".\") + 1) : it.startsWith(\"./\") ? it.substring(2) : it === \".\" ? null : it))\n    .filter(it => it != null && it.length > 0) as Array<string>\n}\n\nexport function packageJson(task: (data: any) => void, isApp = false) {\n  return (projectDir: string) => modifyPackageJson(projectDir, task, isApp)\n}\n\nexport async function modifyPackageJson(projectDir: string, task: (data: any) => void, isApp = false): Promise<any> {\n  const file = isApp ? path.join(projectDir, \"app\", \"package.json\") : path.join(projectDir, \"package.json\")\n  const data = await fs.readFile(file, \"utf-8\").then(it => JSON.parse(it))\n  task(data)\n  // because copied as hard link\n  await fs.unlink(file)\n\n  await fs.writeFile(path.join(projectDir, \".yarnrc.yml\"), \"nodeLinker: node-modules\")\n  return await writeJson(file, data, { spaces: 2 })\n}\n\nexport function platform(platform: Platform): PackagerOptions {\n  return {\n    targets: platform.createTarget(),\n  }\n}\n\nexport function signed(packagerOptions: PackagerOptions): PackagerOptions {\n  if (process.env.CSC_KEY_PASSWORD == null) {\n    log.warn({ reason: \"CSC_KEY_PASSWORD is not defined\" }, \"macOS code signing is not tested\")\n  } else {\n    if (packagerOptions.config == null) {\n      ;(packagerOptions as any).config = {}\n    }\n    ;(packagerOptions.config as any).cscLink = CSC_LINK\n  }\n  return packagerOptions\n}\n\nexport function createMacTargetTest(expect: ExpectStatic, target: Array<MacOsTargetName>, config?: Configuration, isSigned = true) {\n  return app(\n    expect,\n    {\n      targets: Platform.MAC.createTarget(target, Arch.x64),\n      config: {\n        extraMetadata: {\n          repository: \"foo/bar\",\n        } as any,\n        mac: {\n          target,\n        },\n        publish: null,\n        ...config,\n      },\n    },\n    {\n      signed: isSigned,\n      packed: async context => {\n        if (!target.includes(\"tar.gz\")) {\n          return\n        }\n\n        const tempDir = await context.tmpDir.createTempDir({ prefix: \"mac-target-test\" })\n        await exec(\"tar\", [\"xf\", path.join(context.outDir, \"Test App ßW-1.1.0-mac.tar.gz\")], { cwd: tempDir })\n        await assertThat(expect, path.join(tempDir, \"Test App ßW.app\")).isDirectory()\n      },\n    }\n  )\n}\n\nexport async function checkDirContents(expect: ExpectStatic, dir: string) {\n  expect((await walk(dir, file => !path.basename(file).startsWith(\".\"))).map(it => toSystemIndependentPath(it.substring(dir.length + 1)))).toMatchSnapshot()\n}\n\nexport function removeUnstableProperties(data: any) {\n  return JSON.parse(\n    JSON.stringify(data, (name, value) => {\n      if (name.includes(\"size\") || name.includes(\"Size\") || name.startsWith(\"sha\") || name === \"releaseDate\") {\n        // to ensure that some property exists\n        return `@${name}`\n      }\n      // Keep existing test coverage\n      if (value.integrity) {\n        delete value.integrity\n      }\n      return value\n    })\n  )\n}\n\nexport async function verifyAsarFileTree(expect: ExpectStatic, resourceDir: string) {\n  const fs = await readAsar(path.join(resourceDir, \"app.asar\"))\n\n  const stableHeader = JSON.parse(\n    JSON.stringify(fs.header, (name, value) => {\n      // Keep existing test coverage\n      if (value.integrity) {\n        delete value.integrity\n      }\n      return value\n    })\n  )\n  expect(stableHeader).toMatchSnapshot()\n}\n\nexport function toSystemIndependentPath(s: string): string {\n  return path.sep === \"/\" ? s : s.replace(/\\\\/g, \"/\")\n}\n"]}