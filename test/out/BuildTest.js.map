{"version":3,"file":"BuildTest.js","sourceRoot":"","sources":["../src/BuildTest.ts"],"names":[],"mappings":"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","sourcesContent":["import { checkBuildRequestOptions } from \"app-builder-lib\"\nimport { doMergeConfigs } from \"app-builder-lib/out/util/config/config\"\nimport { Arch, createTargets, DIR_TARGET, Platform } from \"electron-builder\"\nimport { createYargs } from \"electron-builder/out/builder\"\nimport { promises as fs } from \"fs\"\nimport { outputFile, outputJson } from \"fs-extra\"\nimport * as path from \"path\"\nimport { app, appTwo, appTwoThrows, assertPack, getFixtureDir, linuxDirTarget, modifyPackageJson, packageJson, toSystemIndependentPath } from \"./helpers/packTester\"\nimport { ELECTRON_VERSION } from \"./helpers/testConfig\"\nimport { verifySmartUnpack } from \"./helpers/verifySmartUnpack\"\nimport { PM } from \"app-builder-lib/src/node-module-collector/packageManager\"\n\ntest.ifLinux(\"cli\", ({ expect }) => {\n  // because these methods are internal\n  const { configureBuildCommand, normalizeOptions } = require(\"electron-builder/out/builder\")\n  const yargs = createYargs()\n  configureBuildCommand(yargs)\n\n  function parse(input: string): any {\n    const options = normalizeOptions(yargs.parse(input))\n    checkBuildRequestOptions(options)\n    return options\n  }\n\n  expect(parse(\"-owl --x64 --ia32\"))\n  expect(parse(\"-mwl --x64 --ia32\"))\n\n  expect(parse(\"--dir\")).toMatchObject({ targets: Platform.current().createTarget(DIR_TARGET) })\n  expect(parse(\"--mac --dir\")).toMatchSnapshot()\n  expect(parse(\"--x64 --dir\")).toMatchObject({ targets: Platform.current().createTarget(DIR_TARGET, Arch.x64) })\n\n  expect(parse(\"--ia32 --x64\")).toMatchObject({ targets: Platform.current().createTarget(null, Arch.x64, Arch.ia32) })\n  expect(parse(\"--linux\")).toMatchSnapshot()\n  expect(parse(\"--win\")).toMatchSnapshot()\n  expect(parse(\"-owl\")).toMatchSnapshot()\n  expect(parse(\"-l tar.gz:ia32\")).toMatchSnapshot()\n  expect(parse(\"-l tar.gz:x64\")).toMatchSnapshot()\n  expect(parse(\"-l tar.gz\")).toMatchSnapshot()\n  expect(parse(\"-w tar.gz:x64\")).toMatchSnapshot()\n  expect(parse(\"-p always -w --x64\")).toMatchSnapshot()\n  expect(parse(\"--prepackaged someDir -w --x64\")).toMatchSnapshot()\n  expect(parse(\"--project someDir -w --x64\")).toMatchSnapshot()\n\n  expect(parse(\"-c.compress=store -c.asar -c ./config.json\")).toMatchObject({\n    config: {\n      asar: true,\n      compress: \"store\",\n      extends: \"./config.json\",\n    },\n  })\n})\n\ntest(\"merge configurations\", ({ expect }) => {\n  const result = doMergeConfigs([\n    {\n      files: [\n        {\n          from: \"dist/renderer\",\n        },\n        {\n          from: \"dist/renderer-dll\",\n        },\n      ],\n    },\n    {\n      files: [\n        {\n          from: \".\",\n          filter: [\"package.json\"],\n        },\n        {\n          from: \"dist/main\",\n        },\n      ],\n    },\n    {\n      files: [\"**/*\", \"!webpack\", \"!.*\", \"!config/jsdoc.json\", \"!package.*\"],\n    },\n    {\n      files: [\n        {\n          from: \".\",\n          filter: [\"!docs\"],\n        },\n      ],\n    },\n    {\n      files: [\"!private\"],\n    },\n  ])\n\n  // console.log(\"data: \" + JSON.stringify(result, null, 2))\n  expect(result).toMatchObject({\n    directories: {\n      output: \"dist\",\n      buildResources: \"build\",\n    },\n    files: [\n      {\n        filter: [\"package.json\", \"**/*\", \"!webpack\", \"!.*\", \"!config/jsdoc.json\", \"!package.*\", \"!docs\", \"!private\"],\n      },\n      {\n        from: \"dist/main\",\n      },\n      {\n        from: \"dist/renderer\",\n      },\n      {\n        from: \"dist/renderer-dll\",\n      },\n    ],\n  })\n})\n\ntest(\"build in the app package.json\", ({ expect }) =>\n  appTwoThrows(\n    expect,\n    { targets: linuxDirTarget },\n    {\n      projectDirCreated: it =>\n        modifyPackageJson(\n          it,\n          data => {\n            data.build = {\n              productName: \"bar\",\n            }\n          },\n          true\n        ),\n    }\n  ))\n\ntest(\"relative index\", ({ expect }) =>\n  appTwo(\n    expect,\n    {\n      targets: linuxDirTarget,\n    },\n    {\n      projectDirCreated: projectDir =>\n        modifyPackageJson(\n          projectDir,\n          data => {\n            data.main = \"./index.js\"\n          },\n          true\n        ),\n    }\n  ))\n\nit.ifDevOrLinuxCi(\"electron version from electron-prebuilt dependency\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n    },\n    {\n      projectDirCreated: async projectDir => {\n        await modifyPackageJson(projectDir, data => {\n          delete data.build.electronVersion\n          data.devDependencies = {}\n        })\n        return () =>\n          outputJson(path.join(projectDir, \"node_modules\", \"electron-prebuilt\", \"package.json\"), {\n            version: ELECTRON_VERSION,\n          })\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi(\"electron version from electron dependency\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n    },\n    {\n      projectDirCreated: async projectDir => {\n        await modifyPackageJson(projectDir, data => {\n          delete data.build.electronVersion\n          data.devDependencies = {}\n        })\n        return () =>\n          outputJson(path.join(projectDir, \"node_modules\", \"electron\", \"package.json\"), {\n            version: ELECTRON_VERSION,\n          })\n      },\n    }\n  )\n)\n\ntest.ifDevOrLinuxCi(\"electron version from build\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n    },\n    {\n      projectDirCreated: projectDir =>\n        modifyPackageJson(projectDir, data => {\n          data.devDependencies = {}\n          data.build.electronVersion = ELECTRON_VERSION\n        }),\n    }\n  )\n)\n\ntest(\"www as default dir\", ({ expect }) =>\n  appTwo(\n    expect,\n    {\n      targets: Platform.LINUX.createTarget(DIR_TARGET),\n    },\n    {\n      projectDirCreated: projectDir => fs.rename(path.join(projectDir, \"app\"), path.join(projectDir, \"www\")),\n    }\n  ))\n\ntest.ifLinuxOrDevMac(\"hooks as functions\", ({ expect }) => {\n  let artifactBuildStartedCalled = 0\n  let artifactBuildCompletedCalled = 0\n  let beforePackCalled = 0\n  let afterPackCalled = 0\n  let afterExtractCalled = 0\n  return assertPack(\n    expect,\n    \"test-app-one\",\n    {\n      targets: createTargets([Platform.LINUX, Platform.MAC], \"zip\", \"x64\"),\n      config: {\n        artifactBuildStarted: () => {\n          artifactBuildStartedCalled++\n        },\n        artifactBuildCompleted: () => {\n          artifactBuildCompletedCalled++\n        },\n        beforePack: () => {\n          beforePackCalled++\n          return Promise.resolve()\n        },\n        afterExtract: () => {\n          afterExtractCalled++\n          return Promise.resolve()\n        },\n        afterPack: () => {\n          afterPackCalled++\n          return Promise.resolve()\n        },\n      },\n    },\n    {\n      packed: async () => {\n        expect(artifactBuildStartedCalled).toEqual(2)\n        expect(artifactBuildCompletedCalled).toEqual(3) // 2 artifacts + blockmap\n        expect(beforePackCalled).toEqual(2)\n        expect(afterExtractCalled).toEqual(2)\n        expect(afterPackCalled).toEqual(2)\n        expect(afterPackCalled).toEqual(2)\n        return Promise.resolve()\n      },\n    }\n  )\n})\n\ntest.ifLinuxOrDevMac(\"hooks as file - cjs\", async ({ expect }) => {\n  const hookScript = path.join(getFixtureDir(), \"build-hook.cjs\")\n  return assertPack(expect, \"test-app-one\", {\n    targets: createTargets([Platform.LINUX, Platform.MAC], \"zip\", \"x64\"),\n    config: {\n      artifactBuildStarted: hookScript,\n      artifactBuildCompleted: hookScript,\n      beforePack: hookScript,\n      afterExtract: hookScript,\n      afterPack: hookScript,\n    },\n  })\n})\n\ntest.ifLinuxOrDevMac(\"hooks as file - mjs exported functions\", async ({ expect }) => {\n  const hookScript = path.join(getFixtureDir(), \"build-hook.mjs\")\n  return assertPack(expect, \"test-app-one\", {\n    targets: createTargets([Platform.LINUX, Platform.MAC], \"zip\", \"x64\"),\n    config: {\n      artifactBuildStarted: hookScript,\n      artifactBuildCompleted: hookScript,\n      beforePack: hookScript,\n      afterExtract: hookScript,\n      afterPack: hookScript,\n    },\n  })\n})\n\ntest.ifWindows(\"afterSign\", ({ expect }) => {\n  let called = 0\n  return assertPack(\n    expect,\n    \"test-app-one\",\n    {\n      targets: createTargets([Platform.LINUX, Platform.WINDOWS], DIR_TARGET),\n      config: {\n        afterSign: () => {\n          called++\n          return Promise.resolve()\n        },\n      },\n    },\n    {\n      packed: async () => {\n        // afterSign is only called when an app is actually signed and ignored otherwise.\n        expect(called).toEqual(1)\n        return Promise.resolve()\n      },\n    }\n  )\n})\n\ntest.ifLinuxOrDevMac(\"beforeBuild\", ({ expect }) => {\n  let called = 0\n  return assertPack(\n    expect,\n    \"test-app-one\",\n    {\n      targets: createTargets([Platform.LINUX, Platform.MAC], DIR_TARGET),\n      config: {\n        npmRebuild: true,\n        beforeBuild: async () => {\n          called++\n          return Promise.resolve()\n        },\n      },\n    },\n    {\n      packed: async () => {\n        expect(called).toEqual(2)\n        return Promise.resolve()\n      },\n    }\n  )\n})\n\n// https://github.com/electron-userland/electron-builder/issues/1738\ntest.ifDevOrLinuxCi(\"win smart unpack\", ({ expect }) => {\n  // test onNodeModuleFile hook\n  const nodeModuleFiles: Array<string> = []\n  let p = \"\"\n  return app(\n    expect,\n    {\n      targets: Platform.WINDOWS.createTarget(DIR_TARGET, Arch.x64),\n      config: {\n        npmRebuild: true,\n        onNodeModuleFile: file => {\n          const name = toSystemIndependentPath(path.relative(p, file))\n          if (!name.startsWith(\".\") && !name.endsWith(\".dll\") && name.includes(\".\")) {\n            nodeModuleFiles.push(name)\n          }\n        },\n        win: {\n          signAndEditExecutable: false, // setting `true` will fail on arm64 macs, even within docker container since rcedit doesn't work within wine on arm64\n        },\n      },\n    },\n    {\n      projectDirCreated: async projectDir => {\n        p = projectDir\n        return modifyPackageJson(projectDir, it => {\n          it.dependencies = {\n            debug: \"3.1.0\",\n            \"edge-cs\": \"1.2.1\",\n            \"@electron-builder/test-smart-unpack\": \"1.0.0\",\n            \"@electron-builder/test-smart-unpack-empty\": \"1.0.0\",\n          }\n        })\n      },\n      packed: async context => {\n        await verifySmartUnpack(expect, context.getResources(Platform.WINDOWS))\n        expect(nodeModuleFiles).toMatchSnapshot()\n      },\n    }\n  )\n})\n\ntest(\"smart unpack local module with dll file\", ({ expect }) => {\n  return app(\n    expect,\n    {\n      targets: Platform.WINDOWS.createTarget(DIR_TARGET, Arch.x64),\n      config: {\n        files: [\n          \"!foo\",\n          \"!**/NuGet\", // for some reason, NuGet only shows up on CI builds, but no Windows VMs or local linux/mac machines\n        ],\n      },\n    },\n    {\n      storeDepsLockfileSnapshot: false,\n      packageManager: PM.NPM,\n      projectDirCreated: async (projectDir, tmpDir) => {\n        const tmpPath = await tmpDir.getTempDir()\n        const localPath = path.join(tmpPath, \"foo\")\n        await outputFile(path.join(localPath, \"package.json\"), `{\"name\":\"foo\",\"version\":\"9.0.0\",\"main\":\"index.js\",\"license\":\"MIT\"}`)\n        await outputFile(path.join(localPath, \"test.dll\"), `test`)\n        await modifyPackageJson(projectDir, data => {\n          data.dependencies = {\n            debug: \"3.1.0\",\n            \"edge-cs\": \"1.2.1\",\n            foo: `file:${localPath}`,\n          }\n        })\n      },\n      packed: async context => {\n        await verifySmartUnpack(expect, context.getResources(Platform.WINDOWS))\n      },\n    }\n  )\n})\n\n// https://github.com/electron-userland/electron-builder/issues/1738\ntest.ifNotWindows(\"posix smart unpack\", ({ expect }) =>\n  app(\n    expect,\n    {\n      targets: linuxDirTarget,\n      config: {\n        // https://github.com/electron-userland/electron-builder/issues/3273\n        // tslint:disable-next-line:no-invalid-template-strings\n        copyright: \"Copyright © 2018 ${author}\",\n        npmRebuild: true,\n        onNodeModuleFile: filePath => {\n          // Force include this directory in the package\n          return filePath.includes(\"node_modules/three/examples\")\n        },\n        files: [\n          // test ignore pattern for node_modules defined as file set filter\n          {\n            filter: [\"!node_modules/napi-build-utils/napi-build-utils-1.0.0.tgz\", \"!node_modules/node-abi/*\", \"!node_modules/**/eslint-format.js\"],\n          },\n        ],\n      },\n    },\n    {\n      projectDirCreated: projectDir => {\n        process.env.npm_config_user_agent = \"npm\"\n        return packageJson(it => {\n          it.dependencies = {\n            debug: \"4.1.1\",\n            \"edge-cs\": \"1.2.1\",\n            keytar: \"7.9.0\",\n            three: \"0.160.0\",\n          }\n        })(projectDir)\n      },\n      packed: async context => {\n        expect(context.packager.appInfo.copyright).toBe(\"Copyright © 2018 Foo Bar\")\n        await verifySmartUnpack(expect, context.getResources(Platform.LINUX), async asarFs => {\n          return expect(await asarFs.readFile(`node_modules${path.sep}three${path.sep}examples${path.sep}fonts${path.sep}README.md`)).toMatchSnapshot()\n        })\n      },\n    }\n  )\n)\n"]}